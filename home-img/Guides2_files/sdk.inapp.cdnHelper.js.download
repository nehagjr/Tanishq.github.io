/*! For license information please see sdk.inapp.cdnHelper.js.LICENSE.txt */
(()=>{var e={483:(e,t,n)=>{e.exports=function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}c=n[s]={exports:{}},t[s][0].call(c.exports,(function(e){return o(t[s][1][e]||e)}),c,c.exports,e,t,n,r)}return n[s].exports}for(var i=void 0,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,r){(function(e){"use strict";var n,r,o,i,s=e.MutationObserver||e.WebKitMutationObserver,a=s?(n=0,s=new s(l),r=e.document.createTextNode(""),s.observe(r,{characterData:!0}),function(){r.data=n=++n%2}):e.setImmediate||void 0===e.MessageChannel?"document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)}:((o=new e.MessageChannel).port1.onmessage=l,function(){o.port2.postMessage(0)}),c=[];function l(){var e,t;i=!0;for(var n=c.length;n;){for(t=c,c=[],e=-1;++e<n;)t[e]();n=c.length}i=!1}t.exports=function(e){1!==c.push(e)||i||a()}}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";var r=e(1);function o(){}var i={},s=["REJECTED"],a=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==o&&f(this,e)}function u(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r((function(){var r;try{r=t(n)}catch(r){return i.reject(e,r)}r===e?i.reject(e,new TypeError("Cannot resolve promise with itself")):i.resolve(e,r)}))}function g(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,i.reject(e,t))}function o(t){n||(n=!0,i.resolve(e,t))}var s=h((function(){t(o,r)}));"error"===s.status&&r(s.value)}function h(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=l).prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var n=new this.constructor(o);return this.state!==c?d(n,this.state===a?e:t,this.outcome):this.queue.push(new u(n,e,t)),n},u.prototype.callFulfilled=function(e){i.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){i.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},i.resolve=function(e,t){var n=h(g,t);if("error"===n.status)return i.reject(e,n.value);if(n=n.value)f(e,n);else{e.state=a,e.outcome=t;for(var r=-1,o=e.queue.length;++r<o;)e.queue[r].callFulfilled(t)}return e},i.reject=function(e,t){e.state=s,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:i.resolve(new this(o),e)},l.reject=function(e){var t=new this(o);return i.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,c=-1,l=new this(o);++c<n;)!function(e,o){t.resolve(e).then((function(e){s[o]=e,++a!==n||r||(r=!0,i.resolve(l,s))}),(function(e){r||(r=!0,i.reject(l,e))}))}(e[c],c);return l},l.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var s=-1,a=new this(o);++s<n;)!function(e){t.resolve(e).then((function(e){r||(r=!0,i.resolve(a,e))}),(function(e){r||(r=!0,i.reject(a,e))}))}(e[s]);return a}},{1:1}],3:[function(e,t,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function i(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var s=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function c(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function l(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var d="local-forage-detect-blob-support",g=void 0,f={},h=Object.prototype.toString,p="readonly",m="readwrite";function v(e){return"boolean"==typeof g?s.resolve(g):(t=e,new s((function(e){var n=t.transaction(d,m),r=i([""]);n.objectStore(d).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||43<=parseInt(t[1],10))}})).catch((function(){return!1})).then((function(e){return g=e})));var t}function b(e){e=f[e.name];var t={};t.promise=new s((function(e,n){t.resolve=e,t.reject=n})),e.deferredOperations.push(t),e.dbReady?e.dbReady=e.dbReady.then((function(){return t.promise})):e.dbReady=t.promise}function S(e){return(e=f[e.name].deferredOperations.pop())&&(e.resolve(),e.promise)}function _(e,t){if(e=f[e.name].deferredOperations.pop())return e.reject(t),e.promise}function y(e,t){return new s((function(n,r){if(f[e.name]=f[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return n(e.db);b(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var s=o.open.apply(o,i);t&&(s.onupgradeneeded=function(t){var n=s.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(d)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),s.onerror=function(e){e.preventDefault(),r(s.error)},s.onsuccess=function(){n(s.result),S(e)}}))}function E(e){return y(e,!1)}function T(e){return y(e,!0)}function w(e,t){if(!e.db)return 1;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;return r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),(o||n)&&(!n||(n=e.db.version+1)>e.version&&(e.version=n),1)}function I(e){return i([function(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}(atob(e.data))],{type:e.type})}function A(e){return e&&e.__local_forage_encoded_blob}function O(e){var t=this,n=t._initReady().then((function(){var e=f[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return c(n,e,e),n}function R(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(0<r&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return s.resolve().then((function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),T(e)})).then((function(){return function(e){b(e);for(var t=f[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,E(e).then((function(t){return e.db=t,w(e)?T(e):t})).then((function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r})).catch((function(t){throw _(e,t),t}))}(e).then((function(){R(e,t,n,r-1)}))})).catch(n);n(o)}}var D={_driver:"asyncStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var o=f[n.name];o||(o={forages:[],db:null,dbReady:null,deferredOperations:[]},f[n.name]=o),o.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=O);var i=[];function a(){return s.resolve()}for(var c=0;c<o.forages.length;c++){var l=o.forages[c];l!==t&&i.push(l._initReady().catch(a))}var u=o.forages.slice(0);return s.all(i).then((function(){return n.db=o.db,E(n)})).then((function(e){return n.db=e,w(n,t._defaultConfig.version)?T(n):e})).then((function(e){n.db=o.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var i=u[r];i!==t&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}}))},_support:function(){try{if(!o)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){R(n._dbInfo,p,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).openCursor(),a=1;s.onsuccess=function(){var n,r=s.result;r?(A(n=r.value)&&(n=I(n)),void 0!==(n=e(n,r.key,a++))?t(n):r.continue()):t()},s.onerror=function(){r(s.error)}}catch(o){r(o)}}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new s((function(t,r){n.ready().then((function(){R(n._dbInfo,p,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).get(e);s.onsuccess=function(){var e=s.result;A(e=void 0===e?null:e)&&(e=I(e)),t(e)},s.onerror=function(){r(s.error)}}catch(o){r(o)}}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var o=new s((function(n,o){var i;r.ready().then((function(){return i=r._dbInfo,"[object Blob]"===h.call(t)?v(i.db).then((function(e){return e?t:(n=t,new s((function(e,t){var r=new FileReader;r.onerror=t,r.onloadend=function(t){t=btoa(t.target.result||""),e({__local_forage_encoded_blob:!0,data:t,type:n.type})},r.readAsBinaryString(n)})));var n})):t})).then((function(t){R(r._dbInfo,m,(function(i,s){if(i)return o(i);try{var a=s.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=a.put(t,e);s.oncomplete=function(){n(t=void 0===t?null:t)},s.onabort=s.onerror=function(){var e=c.error||c.transaction.error;o(e)}}catch(i){o(i)}}))})).catch(o)}));return a(o,n),o},removeItem:function(e,t){var n=this;e=l(e);var r=new s((function(t,r){n.ready().then((function(){R(n._dbInfo,m,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName).delete(e);i.oncomplete=function(){t()},i.onerror=function(){r(s.error)},i.onabort=function(){var e=s.error||s.transaction.error;r(e)}}catch(o){r(o)}}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){R(t._dbInfo,m,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=i.error||i.transaction.error;n(e)}}catch(r){n(r)}}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){R(t._dbInfo,p,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}}catch(r){n(r)}}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){e<0?t(null):n.ready().then((function(){R(n._dbInfo,p,(function(o,i){if(o)return r(o);try{var s=i.objectStore(n._dbInfo.storeName),a=!1,c=s.openCursor();c.onsuccess=function(){var n=c.result;n?0===e||a?t(n.key):(a=!0,n.advance(e)):t(null)},c.onerror=function(){r(c.error)}}catch(o){r(o)}}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){R(t._dbInfo,p,(function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName).openCursor(),s=[];i.onsuccess=function(){var t=i.result;t?(s.push(t.key),t.continue()):e(s)},i.onerror=function(){n(i.error)}}catch(r){n(r)}}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n,r=this.config();return(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName),a(n=e.name?(n=e.name===r.name&&this._dbInfo.db?s.resolve(this._dbInfo.db):E(e).then((function(t){var n=f[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t})),e.storeName?n.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;b(e);var r=f[e.name],i=r.forages;t.close();for(var a=0;a<i.length;a++){var c=i[a];c._dbInfo.db=null,c._dbInfo.version=n}return new s((function(t,r){var i=o.open(e.name,n);i.onerror=function(e){i.result.close(),r(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}})).then((function(e){r.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,S(n._dbInfo)}})).catch((function(t){throw(_(e,t)||s.resolve()).catch((function(){})),t}))}})):n.then((function(t){b(e);var n=f[e.name],r=n.forages;t.close();for(var i=0;i<r.length;i++)r[i]._dbInfo.db=null;return new s((function(t,n){var r=o.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}})).then((function(e){n.db=e;for(var t=0;t<r.length;t++)S(r[t]._dbInfo)})).catch((function(t){throw(_(e,t)||s.resolve()).catch((function(){})),t}))}))):s.reject("Invalid arguments"),t),n}},k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",P=/^~~local_forage_type~([^~]+)~/,N="__lfsc__:",C=N.length,L="arbf",B="blob",M=C+L.length,x=Object.prototype.toString;function U(e){var t,n,r,o,i=.75*e.length,s=e.length,a=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--),i=new ArrayBuffer(i);for(var c=new Uint8Array(i),l=0;l<s;l+=4)t=k.indexOf(e[l]),n=k.indexOf(e[l+1]),r=k.indexOf(e[l+2]),o=k.indexOf(e[l+3]),c[a++]=t<<2|n>>4,c[a++]=(15&n)<<4|r>>2,c[a++]=(3&r)<<6|63&o;return i}function W(e){for(var t=new Uint8Array(e),n="",r=0;r<t.length;r+=3)n+=k[t[r]>>2],n+=k[(3&t[r])<<4|t[r+1]>>4],n+=k[(15&t[r+1])<<2|t[r+2]>>6],n+=k[63&t[r+2]];return t.length%3==2?n=n.substring(0,n.length-1)+"=":t.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var F={serialize:function(e,t){var n="";if(e&&(n=x.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===x.call(e.buffer))){var r,o=N;e instanceof ArrayBuffer?(r=e,o+=L):(r=e.buffer,"[object Int8Array]"===n?o+="si08":"[object Uint8Array]"===n?o+="ui08":"[object Uint8ClampedArray]"===n?o+="uic8":"[object Int16Array]"===n?o+="si16":"[object Uint16Array]"===n?o+="ur16":"[object Int32Array]"===n?o+="si32":"[object Uint32Array]"===n?o+="ui32":"[object Float32Array]"===n?o+="fl32":"[object Float64Array]"===n?o+="fl64":t(new Error("Failed to get type for BinaryArray"))),t(o+W(r))}else if("[object Blob]"===n)(n=new FileReader).onload=function(){var n="~~local_forage_type~"+e.type+"~"+W(this.result);t(N+B+n)},n.readAsArrayBuffer(e);else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}},deserialize:function(e){if(e.substring(0,C)!==N)return JSON.parse(e);var t,n=e.substring(M),r=e.substring(C,M);r===B&&P.test(n)&&(t=(e=n.match(P))[1],n=n.substring(e[0].length));var o=U(n);switch(r){case L:return o;case B:return i([o],{type:t});case"si08":return new Int8Array(o);case"ui08":return new Uint8Array(o);case"uic8":return new Uint8ClampedArray(o);case"si16":return new Int16Array(o);case"ur16":return new Uint16Array(o);case"si32":return new Int32Array(o);case"ui32":return new Uint32Array(o);case"fl32":return new Float32Array(o);case"fl64":return new Float64Array(o);default:throw new Error("Unkown type: "+r)}},stringToBuffer:U,bufferToString:W};function j(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function K(e,t,n,r,o,i){e.executeSql(n,r,o,(function(e,s){s.code===s.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?i(e,s):j(e,t,(function(){e.executeSql(n,r,o,i)}),i)}),i):i(e,s)}),i)}function q(e,t,n,r){var o=this;e=l(e);var i=new s((function(i,s){o.ready().then((function(){var a=t=void 0===t?null:t,c=o._dbInfo;c.serializer.serialize(t,(function(t,l){l?s(l):c.db.transaction((function(n){K(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){i(a)}),(function(e,t){s(t)}))}),(function(t){t.code===t.QUOTA_ERR&&(0<r?i(q.apply(o,[e,a,n,r-1])):s(t))}))}))})).catch(s)}));return a(i,n),i}var H={_driver:"webSQLStorage",_initStorage:function(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new s((function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction((function(o){j(o,n,(function(){t._dbInfo=n,e()}),(function(e,t){r(t)}))}),r)}));return n.serializer=F,o},_support:"function"==typeof openDatabase,iterate:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){K(n,o,"SELECT * FROM "+o.storeName,[],(function(n,r){for(var i=r.rows,s=i.length,a=0;a<s;a++){var c=i.item(a),l=(l=c.value)&&o.serializer.deserialize(l);if(void 0!==(l=e(l,c.key,a+1)))return void t(l)}t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){K(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,n){n=(n=n.rows.length?n.rows.item(0).value:null)&&o.serializer.deserialize(n),t(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},setItem:function(e,t,n){return q.apply(this,[e,t,n,1])},removeItem:function(e,t){var n=this;e=l(e);var r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){K(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},clear:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){K(t,r,"DELETE FROM "+r.storeName,[],(function(){e()}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},length:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){K(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(t,n){n=n.rows.item(0).c,e(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},key:function(e,t){var n=this,r=new s((function(t,r){n.ready().then((function(){var o=n._dbInfo;o.db.transaction((function(n){K(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,n){n=n.rows.length?n.rows.item(0).key:null,t(n)}),(function(e,t){r(t)}))}))})).catch(r)}));return a(r,t),r},keys:function(e){var t=this,n=new s((function(e,n){t.ready().then((function(){var r=t._dbInfo;r.db.transaction((function(t){K(t,r,"SELECT key FROM "+r.storeName,[],(function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments);var n=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r=this,o=e.name?new s((function(t){var o,i=e.name===n.name?r._dbInfo.db:openDatabase(e.name,"","",0);e.storeName?t({db:i,storeNames:[e.storeName]}):t((o=i,new s((function(e,t){o.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).name);e({db:o,storeNames:r})}),(function(e,n){t(n)}))}),(function(e){t(e)}))}))))})).then((function(e){return new s((function(t,n){e.db.transaction((function(r){for(var o=[],i=0,a=e.storeNames.length;i<a;i++)o.push(function(e){return new s((function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){n(t)}))}))}(e.storeNames[i]));s.all(o).then((function(){t()})).catch((function(e){n(e)}))}),(function(e){n(e)}))}))})):s.reject("Invalid arguments");return a(o,t),o}};function z(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function G(e,t){for(var n,r,o=e.length,i=0;i<o;){if((n=e[i])===(r=t)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return 1;i++}}e={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var n in e)t[n]=e[n];return t.keyPrefix=z(e,this._defaultConfig),!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),void localStorage.removeItem(e)}catch(e){return 1}}()||0<localStorage.length?((this._dbInfo=t).serializer=F,s.resolve()):s.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var n=this,r=n.ready().then((function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,i=localStorage.length,s=1,a=0;a<i;a++){var c=localStorage.key(a);if(0===c.indexOf(r)){var l=(l=localStorage.getItem(c))&&t.serializer.deserialize(l);if(void 0!==(l=e(l,c.substring(o),s++)))return l}}}));return a(r,t),r},getItem:function(e,t){var n=this;e=l(e);var r=n.ready().then((function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&t.serializer.deserialize(r)}));return a(r,t),r},setItem:function(e,t,n){var r=this;e=l(e);var o=r.ready().then((function(){var n=t=void 0===t?null:t;return new s((function(o,i){var s=r._dbInfo;s.serializer.serialize(t,(function(t,r){if(r)i(r);else try{localStorage.setItem(s.keyPrefix+e,t),o(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||i(t),i(t)}}))}))}));return a(o,n),o},removeItem:function(e,t){var n=this;e=l(e);var r=n.ready().then((function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(r,t),r},clear:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;0<=n;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}}));return a(n,e),n},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var n=this,r=n.ready().then((function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(r){t=null}return t&&t.substring(r.keyPrefix.length)}));return a(r,t),r},keys:function(e){var t=this,n=t.ready().then((function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&r.push(i.substring(e.keyPrefix.length))}return r}));return a(n,e),n},dropInstance:function(e,t){t=u.apply(this,arguments),(e="function"!=typeof e&&e||{}).name||(r=this.config(),e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n=this,r=e.name?new s((function(t){e.storeName?t(z(e,n._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;0<=t;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}})):s.reject("Invalid arguments");return a(r,t),r}};var V=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Y={},Q={},J={INDEXEDDB:D,WEBSQL:H,LOCALSTORAGE:e},X=(e=[J.INDEXEDDB._driver,J.WEBSQL._driver,J.LOCALSTORAGE._driver],["dropInstance"]),$=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(X),Z={description:"",driver:e.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ee(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(var r in n)n.hasOwnProperty(r)&&(V(n[r])?e[r]=n[r].slice():e[r]=n[r])}return e}function te(e){for(var t in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,te),J){var n,r;J.hasOwnProperty(t)&&(r=(n=J[t])._driver,this[t]=r,Y[r]||this.defineDriver(n))}this._defaultConfig=ee({},Z),this._config=ee({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}e=new(te.prototype.config=function(e){if("object"!==(void 0===e?"undefined":r(e)))return"string"==typeof e?this._config[e]:this._config;if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)},te.prototype.defineDriver=function(e,t,n){var r=new s((function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var i=$.concat("_initStorage"),c=0,l=i.length;c<l;c++){var u=i[c];if((!G(X,u)||e[u])&&"function"!=typeof e[u])return void n(o)}!function(){for(var t=0,n=X.length;t<n;t++){var r=X[t];e[r]||(e[r]=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver");return a(t=s.reject(t),arguments[arguments.length-1]),t}}(r))}}();var d=function(n){Y[r]&&console.info("Redefining LocalForage driver: "+r),Y[r]=e,Q[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,n):d(!!e._support):d(!0)}catch(o){n(o)}}));return c(r,t,n),r},te.prototype.driver=function(){return this._driver||null},te.prototype.getDriver=function(e,t,n){return c(e=Y[e]?s.resolve(Y[e]):s.reject(new Error("Driver not found.")),t,n),e},te.prototype.getSerializer=function(e){var t=s.resolve(F);return c(t,e),t},te.prototype.ready=function(e){var t=this,n=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return c(n,e,e),n},te.prototype.setDriver=function(e,t,n){var r=this;V(e)||(e=[e]);var o=this._getSupportedDrivers(e);function i(){r._config.driver=r.driver()}function a(e){return r._extend(e),i(),r._ready=r._initStorage(r._config),r._ready}return e=null!==this._driverSet?this._driverSet.catch((function(){return s.resolve()})):s.resolve(),this._driverSet=e.then((function(){var e=o[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then((function(e){r._driver=e._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=function(e){return function(){var t=0;return function n(){for(;t<e.length;){var o=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(o).then(a).catch(n)}i();var c=new Error("No available storage method found.");return r._driverSet=s.reject(c),r._driverSet}()}}(o)}))})).catch((function(){i();var e=new Error("No available storage method found.");return r._driverSet=s.reject(e),r._driverSet})),c(this._driverSet,t,n),this._driverSet},te.prototype.supports=function(e){return!!Q[e]},te.prototype._extend=function(e){ee(this,e)},te.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},te.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=$.length;e<t;e++)!function(e,t){e[t]=function(){var n=arguments;return e.ready().then((function(){return e[t].apply(e,n)}))}}(this,$[e])},te.prototype.createInstance=function(e){return new te(e)},te),t.exports=e},{3:3}]},{},[4])(4)},375:(e,t,n)=>{let r;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(r=r||Promise.resolve()).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},967:(e,t,n)=>{e.exports=function(e,t,n){if("number"!=typeof t)throw new Error("second argument must be a Number");let o,i,s,a,c,l,u=!0;function d(e){function t(){n&&n(e,o),n=null}u?r(t):t()}function g(t,n,r){if(o[t]=r,n&&(c=!0),0==--s||n)d(n);else if(!c&&l<i){let t;a?(t=a[l],l+=1,e[t]((function(e,n){g(t,e,n)}))):(t=l,l+=1,e[t]((function(e,n){g(t,e,n)})))}}s=i=Array.isArray(e)?(o=[],e.length):(a=Object.keys(e),o={},a.length),l=t,s?a?a.some((function(n,r){return e[n]((function(e,t){g(n,e,t)})),r===t-1})):e.some((function(e,n){return e((function(e,t){g(n,e,t)})),n===t-1})):d(null),u=!1};const r=n(375)},877:(e,t,n)=>{var r=n(570),o=n(171);(n=o).v1=r,n.v4=o,e.exports=n},327:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var r=n||0;return[(n=t)[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[+r]]].join("")}},217:e=>{var t,n,r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);r?(t=new Uint8Array(16),e.exports=function(){return r(t),t}):(n=new Array(16),e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n})},570:(e,t,n)=>{var r,o,i=n(217),s=n(327),a=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||r,g=void 0!==e.clockseq?e.clockseq:o;null!=d&&null!=g||(h=i(),null==d&&(d=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==g&&(g=o=16383&(h[6]<<8|h[7])));var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=(n=void 0!==e.nsecs?e.nsecs:c+1,f-a+(n-c)/1e4);if(h<0&&void 0===e.clockseq&&(g=g+1&16383),1e4<=(n=(h<0||a<f)&&void 0===e.nsecs?0:n))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,o=g,n=(1e4*(268435455&(f+=122192928e5))+(c=n))%4294967296,u[l++]=n>>>24&255,u[l++]=n>>>16&255,u[l++]=n>>>8&255,u[l++]=255&n,f=f/4294967296*1e4&268435455,u[l++]=f>>>8&255,u[l++]=255&f,u[l++]=f>>>24&15|16,u[l++]=f>>>16&255,u[l++]=g>>>8|128,u[l++]=255&g;for(var p=0;p<6;++p)u[l+p]=d[p];return t||s(u)}},171:(e,t,n)=>{var r=n(217),o=n(327);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[i+a]=s[a];return t||o(s)}}},t={};function n(r){var o=t[r];return void 0!==o||(o=t[r]={exports:{}},e[r](o,o.exports,n)),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{"use strict";function e(t,n,r){return null!=t&&n?(t=t[(n=Array.isArray(n)?n:n.split("."))[0]])&&1<n.length?e(t,n.slice(1),r):void 0===t?r||null:t:null}n.r(r);var t=n(877);class o{constructor(e,t){this.channel=e,this.target=t}sendMessage(e,n){return new Promise(((r,o)=>{var i={id:(0,t.v4)(),channel:this.channel,topic:e,message:n};this.addToListener(i,r,o),this.target instanceof HTMLIFrameElement?this.target.contentWindow.postMessage(i,this.target.src):this.target.postMessage(i,"*")}))}static listenToChannel(e,t,n){window.addEventListener("message",(r=>{r.data&&r.data.channel&&r.data.topic&&r.data.channel===e&&r.data.topic===t&&n(r.data,(n=>{n={id:r.data.id,channel:e,topic:t,message:n},r.source.postMessage(n,r.origin)}))}))}addToListener(t,n,r){o.pendingPromises[t.id]={resolve:n,reject:r},window.addEventListener("message",(t=>{t.data&&e(t.data,"channel",null)===this.channel&&null!=o.pendingPromises[t.data.id]&&(o.pendingPromises[t.data.id].resolve(t.data),delete o.pendingPromises[t.data.id])}))}}o.pendingPromises={};const i="initData",s="browserDetails",a="unifiedLogs",c={USER_DATA:"USER_DATA",PUSH_TOKEN:"PUSH_TOKEN",SUBSCRIPTION_DETAILS:"SUBSCRIPTION_DETAILS",SETUP_TIME:"SETUP_TIME",OPT_IN_SHOWN_TIME:"OPT_IN_SHOWN_TIME",SOFT_ASK_STATUS:"SOFT_ASK_STATUS",HARD_ASK_STATUS:"HARD_ASK_STATUS",WEB_SETTINGS:"WEB_SETTINGS",GRACEFUL_DATA:"GRACEFUL_DATA",Q:{PREFIX:"Q",REPORT:"REPORT",DEVICE:"DEVICE"},INIT_DATA:"INIT_DATA",OLD_SDK:{USER_DATA:"moengage_data",SUBSCRIPTION_DETAILS:"MOE_PUSH_ENDPOINT",PUSH_TOKEN:"MOE_PUSH_TOKEN"},BROWSER_DETAILS:"browserDetails",SESSION:"SESSION"},l=2,u="MOE_WEB_UNSUBSCRIBED",d="MOE_WEB_OPTIN_BANNER_LOAD",g="MOE_OPT_IN_SHOWN",f="MOE_OPT_IN_ATTEMPT",h="MOE_LOGOUT",p="EVENT_ACTION_DEVICE_ATTRIBUTE",m="USER_ATTRIBUTE_UNIQUE_ID",v="USER_ATTRIBUTE_USER_EMAIL",b="USER_ATTRIBUTE_USER_NAME",S="USER_ATTRIBUTE_USER_FIRST_NAME",_="USER_ATTRIBUTE_USER_LAST_NAME",y="USER_ATTRIBUTE_USER_MOBILE",E="USER_ATTRIBUTE_USER_GENDER",T="USER_ATTRIBUTE_USER_BDAY",w="USER_ID_MODIFIED_FROM",I="moe",A="moe-subd",O="STORAGE",R="EPHEMERAL_STORAGE",D="PERMISSION_STATE",k="CONFIG",P="HARD_ASK_RESULT",N="SHOW_NOTIF",C={DC_1:"sdk-01.moengage.com",DC_2:"sdk-02.moengage.com",DC_3:"sdk-03.moengage.com",DC_4:"sdk-04.moengage.com",DC_5:"sdk-05.moengage.com",DC_100:"sdk-100.moengage.com",eu:"sdk-02.moengage.com",in:"sdk-03.moengage.com"},L="SESSION",B="v3/sdkconfig/",M="moe_uuid",x="web_personalization",U={CLICK:"MOE_ONSITE_MESSAGE_CLICKED",IMPRESSION:"MOE_ONSITE_MESSAGE_SHOWN",DISMISS:"MOE_ONSITE_MESSAGE_DISMISSED",AUTO_DISMIS:"MOE_ONSITE_MESSAGE_AUTO_DISMISS",TYPE:"onsite"},W="moe_inapp_draft_type",F="moe_inapp_draft_id",j="moe_inapp_draft_tag",K="test_campaign_meta",q="test_template_type",H="moe_inapp_draft_variation",z="moe_inapp_draft_locale";var G;(Re=G=G||{}).BLOCKED="blocked",Re.ALLOWED="allowed";const V={NAME:"offline_data"},Y="v2/sdk/report/",Q=15e3,J={TOPIC:"MOE_AUTOMATED_EVENTS",NAMES:[u,"EVENT_ACTION_WEB_SESSION_START","MOE_PAGE_VIEWED",d,"MOE_WEB_OPTIN_CLOSED","MOE_WEB_OPTIN_ACCEPTED","MOE_USER_SUBSCRIBED",f,g,"MOE_OPT_IN_ALLOWED","MOE_OPT_IN_DISMISSED","MOE_OPT_IN_BLOCKED",h,U.CLICK,U.IMPRESSION,U.DISMISS,U.AUTO_DISMIS]},X=[f];class ${static set(e,t){$.baseLogTag,window&&(window.moeInternals?window.moeInternals.ephemeral||(window.moeInternals.ephemeral={}):(window.moeInternals={},window.moeInternals.ephemeral={}),window.moeInternals.ephemeral[e]=t)}static get(t){return e(window,"moeInternals.ephemeral."+t,null)}}$.baseLogTag="EphemeralStorage";var Z=n(483);class ee{constructor(){this.items=[]}static enqueue(e,t){e=ee.getLocalStorageQName(e);let n=new ee;ne.get(e)&&(n=ne.get(e)),n.items.push(t),n.items=n.items.slice(Math.max(n.items.length-50,0)),ne.set(e,n)}static dequeue(e){e=ee.getLocalStorageQName(e);const t=ne.get(e);let n=null;return t&&0<t.items.length&&(n=t.items[0],t.items.splice(0,1),ne.set(e,t)),n}static isEmpty(e){return e=ee.getLocalStorageQName(e),!(ne.get(e)&&0<ne.get(e).items.length)}static purge(e){var t=ee.getLocalStorageQName(e);ee.isEmpty(e)||ne.remove(t)}static getLocalStorageQName(e){return c.Q.PREFIX+"_"+e}}const te="MOE_DATA";class ne{static setPrefix(e){ne.prefix=e+"_"}static set(e,t){if(ne.baseLogTag,e=ne.prefix+e,localStorage){const n=ne.getMoeData();n[e]=t,localStorage.setItem(te,JSON.stringify(n))}var n=ne.KEYS_SHARED_WITH_COOKIE.indexOf(e);if(ne.isSharedWithCookie&&0<=n){const r="object"!=typeof t||Array.isArray(t)?t:Object.assign({},t);0===n&&Array.isArray(r.attributes)&&(r.attributes=r.attributes.filter((e=>{switch(e.key){case m:case w:case v:case y:return!0;default:return!1}}))),e===c.SUBSCRIPTION_DETAILS&&(r.domain=t.domain,r.token=t.token,r.endpoint=t.endpoint,r.keys=t.keys),vt.set(e,r)}}static get(t){return ne.baseLogTag,t=ne.prefix+t,localStorage?e(ne.getMoeData(),t,null):null}static remove(e){var t=ne.baseLogTag+".remove",n=ne.prefix+e;if(localStorage&&null!=ne.get(e)){const r=ne.getMoeData();delete r[n],localStorage.setItem(te,JSON.stringify(r)),mt.log(2,t,"Key",e,"removed.")}ne.isSharedWithCookie&&0<=ne.KEYS_SHARED_WITH_COOKIE.indexOf(e)&&vt.remove(e)}static logout(){const e=["INIT_DATA","Q","WEB_SETTINGS","SUBSCRIPTION_DETAILS","PUSH_TOKEN","GRACEFUL_DATA"];for(const t in c)e.indexOf(t)<0&&ne.remove(c[t]);for(const e in c.Q)ee.purge(e)}static getString(e){if(e=ne.prefix+e,localStorage)return"string"==typeof(e=ne.get(e))||e instanceof String?e:JSON.stringify(e)}static removePrefix(){ne.prefix=""}static copyKeysFromCookie(){for(let n=0;n<ne.KEYS_SHARED_WITH_COOKIE.length;n++){var e=ne.KEYS_SHARED_WITH_COOKIE[n],t=vt.get(e);if(null!=t){const n="object"!=typeof t||Array.isArray(t)?t:Object.assign({},t);if(e===c.USER_DATA&&(t=ne.get(e)&&ne.get(e).attributes,Array.isArray(n.attributes)&&Array.isArray(t)&&0<t.length)){const e=[...t];n.attributes.forEach((t=>{var n=e.findIndex((e=>e.key===t.key));0<=n&&(e[n]=t)})),n.attributes=e}ne.set(e,n)}}}static getMoeData(){var e=ne.baseLogTag+".getMoeData",t=localStorage.getItem(te);if(null==t)return{};try{return JSON.parse(t)}catch(t){return mt.error(1,e,t),{}}}}var re;ne.baseLogTag="PersistentStorage",ne.prefix="",ne.isSharedWithCookie=!1,ne.KEYS_SHARED_WITH_COOKIE=[c.USER_DATA,c.SUBSCRIPTION_DETAILS,c.SOFT_ASK_STATUS,c.SETUP_TIME,c.PUSH_TOKEN,c.OPT_IN_SHOWN_TIME,c.HARD_ASK_STATUS];class oe{constructor(e,t,n){this.os="web",this.osPlatform=e.userAgent,this.isMobile=_e(),this.os=_e()?"mweb":"web",this.name=oe.getBrowserName(e.userAgent,t),this.isIncognito=n}static getInstance(){return e=this,n=function*(){if(null!=$.get(s))return $.get(s);var e=yield oe.isIncognito(window),t=new oe(navigator,document,e);return $.set(s,t),(e=ne.get(c.BROWSER_DETAILS))&&oe.isBrowserUpdated(e,t)||ne.set(s,t),t},new(t=(t=void 0)||Promise)((function(r,o){function i(e){try{a(n.next(e))}catch(e){o(e)}}function s(e){try{a(n.throw(e))}catch(e){o(e)}}function a(e){var n;e.done?r(e.value):((n=e.value)instanceof t?n:new t((function(e){e(n)}))).then(i,s)}a((n=n.apply(e,[])).next())}));var e,t,n}static isIncognito(e){const t=e.RequestFileSystem||e.webkitRequestFileSystem;return new Promise((n=>{t?t(e.TEMPORARY,100,(()=>{n(!1)}),(()=>{n(!0)})):n(!1)}))}static getBrowserName(e,t){return-1!==e.indexOf("MSIE")||1==t.documentMode?oe.BROWSER_NAMES.INTERNET_EXPLORER:-1<e.indexOf("Edg")?oe.BROWSER_NAMES.EDGE:-1<e.indexOf("OPR")||-1<e.indexOf("Opera")?oe.BROWSER_NAMES.OPERA:-1<e.indexOf("Chrome")||e.match(/\b(?:crmo|crios)\/([\w\.]+)/i)?-1<e.indexOf("MMS")?oe.BROWSER_NAMES.OPERA_NEON:oe.BROWSER_NAMES.CHROME:-1<e.indexOf("Safari")?oe.BROWSER_NAMES.SAFARI:-1<e.indexOf("Firefox")?oe.BROWSER_NAMES.FIREFOX:oe.BROWSER_NAMES.OTHERS}static isBrowserUpdated(e,t){return Te(e,t)}isWebPushCompatible(){return this.isChrome()||this.isFirefox()||this.isOpera()||this.isSafari()||this.isEdge()}isChrome(){return this.name===oe.BROWSER_NAMES.CHROME}isFirefox(){return this.name===oe.BROWSER_NAMES.FIREFOX}isOpera(){return this.name===oe.BROWSER_NAMES.OPERA||this.name===oe.BROWSER_NAMES.OPERA_NEON}isSafari(){return this.name===oe.BROWSER_NAMES.SAFARI}isEdge(){return this.name===oe.BROWSER_NAMES.EDGE}static isIOS(){return!(!navigator.userAgent.match(/iPad/i)&&!navigator.userAgent.match(/iPhone/i))}}(bt=(bt=oe=oe||{}).BROWSER_NAMES||(bt.BROWSER_NAMES={})).CHROME="Google Chrome",bt.FIREFOX="Mozilla Firefox",bt.OPERA="Opera",bt.OPERA_NEON="Opera Neon",bt.SAFARI="Apple Safari",bt.INTERNET_EXPLORER="Internet Explorer",bt.EDGE="Edge",bt.OTHERS="Others";const ie=oe;class se{constructor(t){var n=se.baseLogTag+".constructor";t.placeholder||mt.warn(1,n,"Placeholder for cards inbox not passed in cardsConfig: ",t),this.placeholder=e(t,"placeholder",""),this.overLayColor=e(t,"overLayColor","rgba(0, 0, 0, 0.8)"),this.backgroundColor=e(t,"backgroundColor","#F6FBFC"),this.navigationBar=new ae(e(t,"navigationBar",{})),this.closeButton=new ue(e(t,"closeButton",{})),this.tab=new de(e(t,"tab",{})),this.cardDismiss=new ge(e(t,"cardDismiss",{})),this.optionButtonColor=e(t,"optionButtonColor","#C4C4C4"),this.dateTimeColor=e(t,"dateTimeColor","#8E8E8E"),this.unclickedCardIndicatorColor=e(t,"unclickedIndicatorColor","blue"),this.pinIcon=e(t,"pinIcon","https://app-cdn.moengage.com/sdk/pin-icon.svg"),this.refreshIcon=e(t,"refreshIcon","https://app-cdn.moengage.com/sdk/refresh-icon.svg"),this.webFloating=new pe(e(t,"webFloating",{})),this.mWebFloating=new pe(e(t,"mWebFloating",{countBackgroundColor:"#FF5A5F",enable:!1,icon:"https://app-cdn.moengage.com/sdk/bell-icon.svg",countColor:"#fff",postion:"0px 10px 40px 0",iconBackgroundColor:"#D9DFED"})),this.card=new le(e(t,"card",{})),this.errorContent=new ce(e(t,"errorContent",{})),this.noDataContent=new me(e(t,"noDataContent",{})),this.openInbox=e(t,"openInbox",(()=>{})),this.zIndex=e(t,"zIndex","999999"),this.fontFaces=(null===(t=t.fontFaces)||void 0===t?void 0:t.map((e=>new fe(e))))||[]}}se.baseLogTag="CardsConfigModel";class ae{constructor(t){this.backgroundColor=e(t,"backgroundColor","#00237C"),this.text=e(t,"text","Notification"),this.color=e(t,"color","#fff"),this.fontSize=e(t,"fontSize","16px"),this.fontFamily=e(t,"fontFamily","inherit")}}class ce{constructor(t={}){this.img=e(t,"img","https://app-cdn.moengage.com/sdk/cards-error.svg"),this.text=e(t,"text",'Error something went wrong <button onclick="window.location.reload();" style="color: #06A6B7; display: contents;" class="btn-icon pointer-cursor" >Refresh</button>')}}class le{constructor(t){this.headerFontSize=e(t,"headerFontSize","16px"),this.descriptionFontSize=e(t,"descriptionFontSize","14px"),this.ctaFontSize=e(t,"ctaFontSize","12px"),this.fontFamily=e(t,"fontFamily","inherit"),this.horizontalRowColor=e(t,"horizontalRowColor","#D9DFED")}}class ue{constructor(t){this.mWebIcon=e(t,"mWebIcon","https://app-cdn.moengage.com/sdk/back-icon.svg"),this.webIcon=e(t,"webIcon","https://app-cdn.moengage.com/sdk/cross-icon.svg"),this.callBack=e(t,"callBack",(()=>{}))}}class de{constructor(t){this.inactiveTabFontColor=e(t,"inactiveTabFontColor","#7C7C7C"),this.fontSize=e(t,"fontSize","14px"),this.fontFamily=e(t,"fontFamily","inherit"),this.backgroundColor=e(t,"backgroundColor","#F6FBFC"),this.active=new he(e(t,"active",{}))}}class ge{constructor(t){this.color=e(t,"color","red"),this.enable=e(t,"enable",!1)}}class fe{constructor(t){this.family=e(t,"family",""),this.url=e(t,"url","")}}class he{constructor(t){this.color=e(t,"color","#06A6B7"),this.underlineColor=e(t,"underlineColor","#06A6B7"),this.backgroundColor=e(t,"backgroundColor","transparent")}}class pe{constructor(t){this.enable=e(t,"enable",!1),this.icon=e(t,"icon","https://app-cdn.moengage.com/sdk/bell-icon.svg"),this.postion=e(t,"postion","0px 10px 40px 0"),this.countBackgroundColor=e(t,"countBackgroundColor","#FF5A5F"),this.countColor=e(t,"countColor","#fff"),this.zIndex=e(t,"zIndex","999998"),this.iconBackgroundColor=e(t,"iconBackgroundColor","#D9DFED"),this.fontFamily=e(t,"fontFamily","inherit")}}class me{constructor(t){this.img=e(t,"img","https://app-cdn.moengage.com/sdk/cards-no-result.svg"),this.text=e(t,"text","No notifications to show, check again later.")}}class ve{constructor(t){this.debugLevel=0,this.cluster=null,this.environment=null,this.baseDomainName="https://sdk-01.moengage.com/",this.inapp=null,this.customSoftAsk=null;var n=ve.baseLogTag+".constructor";null!=e(t,"app_id",null)?(this.appId=e(t,"app_id",null),this.integrationType=re.OLD_SDK):null!=e(t,"appId",null)?(this.appId=e(t,"appId",null),this.integrationType=re.NEW_SDK):(mt.error(1,n,"App Id not specified. Please check docs page to complete the integration - ","https://docs.moengage.com/docs/web-sdk-integration"),this.integrationType=null),null!=e(t,"debug_logs",null)?this.debugLevel=e(t,"debug_logs",0):null!=e(t,"debugLevel",null)?this.debugLevel=e(t,"debugLevel",0):(mt.log(2,n,"No log level config found. Using default value of",0),this.debugLevel=0),this.appId&&(this.baseDomainName="https://sdk-01.moengage.com/",this.forceSwUpdate=e(t,"forceSwUpdate",!1),this.cluster=e(t,"cluster",null),this.cluster&&null!=C[this.cluster]&&(this.environment=C[this.cluster]),e(t,"environment",null)&&(this.environment=t.environment),this.environment&&(this.baseDomainName="https://"+this.environment+"/"),0<this.debugLevel&&this.appId.indexOf("_DEBUG")<0?this.appId=this.appId+"_DEBUG":0===this.debugLevel&&0<=this.appId.indexOf("_DEBUG")&&(this.appId=this.appId.substr(0,this.appId.indexOf("_DEBUG"))),this.swPath=e(t,"swPath",null),null!=t.customSoftAsk?this.customSoftAsk={mainClass:e(t,"customSoftAsk.mainClass",null),allowClass:e(t,"customSoftAsk.allowClass",null),dismissClass:e(t,"customSoftAsk.dismissClass",null)}:this.customSoftAsk={mainClass:e(t,"main_class",null),allowClass:e(t,"allow_class",null),dismissClass:e(t,"block_class",null)},null!=e(t,"inapp.host",null)&&(this.inapp={host:e(t,"inapp.host",null)}),null!=e(t,"swScope",null)&&(this.swScope=e(t,"swScope",null)),null!=e(t,"disable_onsite",null)&&(this.disableOnsite=e(t,"disable_onsite",!1)),null!=e(t,"enableSPA",null)&&(this.enableSPA=e(t,"enableSPA",!1)),null!=e(t,"cards",null)&&(this.cards=new se(e(t,"cards",{}))),null!=e(t,"api_proxy_domain",null)&&(this.apiProxyDomain=e(t,"api_proxy_domain",null),this.baseDomainName="https://"+this.apiProxyDomain+"/",this.environment=this.apiProxyDomain),null!=e(t,"disable_web_push",null)&&(this.disableWebPush=e(t,"disable_web_push",!1)))}static save(e){$.set(i,new ve(e)),ne.set(c.INIT_DATA,new ve(e))}static get(){return $.get(i)}static setSoftAskConfig(t){var n=ve.get();t={appId:n.appId,debugLevel:n.debugLevel,cluster:n.cluster,environment:n.environment,swPath:n.swPath,enableSPA:n.enableSPA,cards:n.cards,apiProxyDomain:n.apiProxyDomain,customSoftAsk:{mainClass:e(t,"main_class",e(t,"mainClass",null)),allowClass:e(t,"allow_class",e(t,"allowClass",null)),dismissClass:e(t,"block_class",e(t,"dismissClass",null))}},ve.save(t)}}function be(e){return 0===Object.keys(e).length&&e.constructor===Object}function Se(){if(window)return"localhost"===window.location.hostname?"https":"http:"===window.location.protocol?"http":"https:"===window.location.protocol?"https":void 0}function _e(){const e=navigator.userAgent;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))}function ye(){var e=navigator.userAgent.toLowerCase(),t=/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(e);return/nexus player|neo-x5|adt-2|tsbnettv|roku|tizen|smart-tv.+(samsung)|hbbtv.+maple;(\d+)|(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))|(apple) ?tv|crkey|droid.+aft(\w)( bui|\))|\(dtv[\);].+(aquos)|(aquos-tv[\w ]+)\)|(bravia[\w ]+)( bui|\))|(mitv-\w{5}) bui|Hbbtv.*(technisat) (.*);|\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)|hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)|\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i.test(e)?"tv":t?"tablet":_e()?"mobile":"web"}function Ee(e,t){var n=ye();return!("allowed"!==e.s_e_b_e||("web"!==n||t.name!==ie.BROWSER_NAMES.CHROME&&t.name!==ie.BROWSER_NAMES.EDGE&&t.name!==ie.BROWSER_NAMES.OPERA)&&("mobile"!==n||ie.isIOS()||t.name!==ie.BROWSER_NAMES.CHROME&&t.name!==ie.BROWSER_NAMES.OPERA)||!navigator.sendBeacon)}ve.baseLogTag="InitData",(Re=re=re||{}).OLD_SDK="OLD_SDK",Re.NEW_SDK="NEW_SDK";function Te(e,t){if(null==e||null==t)return e===t;if(e instanceof Function)return e===t;if(e instanceof RegExp)return e===t;if(e===t||e.valueOf()===t.valueOf())return!0;if(Array.isArray(e)&&e.length!==t.length)return!1;if(e instanceof Date)return!1;if(!(e instanceof Object))return!1;if(!(t instanceof Object))return!1;const n=Object.keys(e);return Object.keys(t).every((e=>-1!==n.indexOf(e)))&&n.every((n=>Te(e[n],t[n])))}function we(){const e=new Date;return`${e.getDate()}:${e.getMonth()+1}:${e.getFullYear()}:${e.getHours()}:${e.getMinutes()}:`+e.getSeconds()}const Ie=e=>{if(e){const t=e.replace("?","").split("&"),n={};return t.forEach((e=>{e=(t=e.split("="))[0];var t=decodeURIComponent(t[1]||"");n[e]?"[object Array]"===Object.prototype.toString.call(n[e])?n[e].push(t):n[e]=[n[e],t]:n[e]=t})),JSON.parse(JSON.stringify(n))}return{}},Ae=(e,t)=>{e+="?";for(const n in t)t.hasOwnProperty(n)&&null!=t[n]&&(e+=n+"="+encodeURIComponent(t[n])+"&");return e};var Oe,Re;class De{static get(e,t){return De.makeNetworkCall(De.METHODS.GET,e,t)}static post(e,t){return De.makeNetworkCall(De.METHODS.POST,e,t)}static makeNetworkCall(t,n,r={}){return new Promise(((o,i)=>{var s=JSON.stringify(e(r,"postData",null));n=Ae(n,e(r,"queryParams",null));const a=new XMLHttpRequest;a.open(t,n,!0),De.addRequestHeaders(a,e(r,"headers",{})),a.onreadystatechange=()=>{4===a.readyState&&200===a.status||4===a.readyState&&410===a.status?o({status:a.status,responseText:a.responseText}):4===a.readyState&&200!==a.status&&i({code:a.status,reason:a.responseText})},a.send(s)}))}static addRequestHeaders(e,t){for(const n in t)t.hasOwnProperty(n)&&e.setRequestHeader(n,t[n]);return e}}(bt=(bt=De=De||{}).METHODS||(bt.METHODS={})).GET="GET",bt.POST="POST";const ke=De;class Pe{initiateSessionAndSource(e){return new Promise(((t,n)=>{var r=()=>{this.isSessionRunning()&&this.isCurrentSourceSameAsPreviousSource()||this.startNewSession(),t(!0)};e?r():setTimeout(r,250)}))}isSessionRunning(){return this.getSessionKey()&&!this.isSessionExpired()}isSessionExpired(){var e=this.getSessionExpiryTime(),t=$.get("wasBrowserInactive");return!(!t&&null!==t)&&(this.isWindowActive()&&$.set("wasBrowserInactive",!1),(new Date).getTime()>e)}isNonEventInteractive(e){return Pe.NON_INTERACTIVE_EVENTS.includes(e.name)||0<e.attributes.filter((e=>"moe_non_interactive"===e.key&&1===e.value)).length}getCurrentSource(){const e=Ie(window.location.search);let t="";const n={};if(Object.keys(e).includes("utm_source")){t="utm_",this.geCustomIdentifiersToTrack().forEach((t=>{e[t]&&(n[t]=e[t])}));const r={source_url:window.location.href};return e[t+"source"]&&(r.source=e[t+"source"]),e[t+"medium"]&&(r.medium=e[t+"medium"]),e[t+"term"]&&(r.term=e[t+"term"]),e[t+"campaign"]&&(r.campaign_name=e[t+"campaign"]),e[t+"content"]&&(r.content=e[t+"content"]),e.utm_id&&(r.campaign_id=e.utm_id),Object.keys(n).length&&(r.extra=n),r}}getActiveSource(){return this.getSavedSource()||this.getCurrentSource()}isSourceOrganic(){const e=Ie(window.location.search),t=Object.keys(e);let n=!1;return this.geCustomIdentifiersToTrack().forEach((t=>{e[t]&&(n=!0)})),!t.includes("utm_source")&&!t.includes("source")&&!n}setCurrentSource(e){const t=this.getSession();t.currentSource=e,ne.set(L,t)}removeCurrentSource(){const e=this.getSession();e&&(e.currentSource=void 0,ne.set(L,e))}getSavedSource(){var t=e(this.getSession(),"currentSource",void 0);if(t)return t}isCurrentSourceSameAsPreviousSource(){if(this.isSourceOrganic())return!0;const e=Object.assign({},this.getCurrentSource());delete e.source_url;const t=Object.assign({},this.getSavedSource());return delete t.source_url,Te(e,t)}getSessionKey(){return e(this.getSession(),"sessionKey",null)}getSessionStartTime(){return e(this.getSession(),"sessionStartTime",null)}getSessionExpiryTime(){return e(this.getSession(),"sessionExpiryTime",null)}getSessionMaxTime(){return e(this.getSession(),"sessionMaxTime",null)}getSession(){return ne.get(L)}geCustomIdentifiersToTrack(){return e(this.getSession(),"customIdentifiersToTrack",[])||[]}generateSessionKey(){return(0,t.v4)()}startNewSession(){this.removeCurrentSource(),ft.getWebSDKSettings().then((e=>{var t=this.getNumberOfSessions();t={sessionKey:this.generateSessionKey(),sessionStartTime:(new Date).toISOString(),sessionMaxTime:e.s_i_d,sessionEnabled:e.s_s_s,customIdentifiersToTrack:e.src_ext,sessionExpiryTime:(new Date).getTime()+1e3*e.s_i_d,numberOfSessions:++t},ne.set(L,t)})).catch((e=>{}))}extendSession(){const e=this.getSession();e&&(e.sessionExpiryTime=(new Date).getTime()+1e3*e.sessionMaxTime,ne.set(L,e))}handleBrowserInactivity(e){"hidden"===e&&$.set("wasBrowserInactive",!0)}isWindowActive(){return!!$.get("isWindowActive")}getNumberOfSessions(){return e(ne.get(L),"numberOfSessions")||0}}Pe.NON_INTERACTIVE_EVENTS=[d,g,d,h];const Ne=n(967),Ce=c.Q;class Le{static clear(e){var t=Le.baseLogTag+".clear";const n=[];for(;!ee.isEmpty(e);)switch(e){case Ce.REPORT:const r=ee.dequeue(Ce.REPORT);n.push((e=>{ft.reportAdd(r).then((()=>{e()}))}));break;case Ce.DEVICE:ee.dequeue(Ce.DEVICE)&&n.push((e=>{ft.deviceAdd().then((()=>{e()}))}));break;default:mt.error(1,t,"Do not know how to handle queue with name:",e)}setTimeout((()=>{Le.processing[e]=!0,Ne(n,5,((t,n)=>{Le.processing[e]=!1}))}),0)}static startPeriodicClear(t){const n=Le.baseLogTag+".startPeriodicCleanQ";Le.clearInterval(t);var r=()=>{ee.isEmpty(t)?(mt.log(1,n,"If you see multiple event tracks with same, they were captured over multiple visits or page refreshes."),e(Le.processing,t,!1)||Le.clearInterval(t)):(Le.clear(t),mt.log(1,n,"Starting periodic queue clear for",t))};r(),Le.intervals[t]=setInterval(r,6e3)}static clearInterval(e){null!=Le.intervals[e]&&(clearInterval(Le.intervals[e]),Le.intervals[e]=null)}}Le.baseLogTag="QManager",Le.intervals={},Le.processing={};class Be{constructor(e,t){this.key=e,this.value=t}static equal(e,t){return e.key===t.key&&JSON.stringify(e.value)===JSON.stringify(t.value)}}class Me{static isTokenValid(e,t){return new Promise(((n,r)=>{var o,i;null!=e&&null!=t?(o="https://iid.googleapis.com/iid/info/"+e+"?details=true",i={headers:{authorization:"key="+t}},ke.get(o,i).then((e=>{200===e.status?n(!0):n(!1)})).catch((r=>{0===r.code?setTimeout((()=>{n(Me.isTokenValid(e,t))}),3e3):n(!1)}))):n(!1)}))}}(Re=Oe=Oe||{}).PROMPT="prompt",Re.GRANTED="granted",Re.DENIED="denied",Re.DISMISSED="dismissed";class xe{constructor(e){this.sdkSettings=e,this.getIframe(),o.listenToChannel(A,k,((e,t)=>{t(this.sdkSettings)}))}showHardAsk(){return xe.baseLogTag,new Promise(((e,t)=>{this.getIframeCommunicator().then((t=>{t.sendMessage(R,{requestType:"set",key:i,value:ve.get()}).then((n=>{t.sendMessage(O,{requestType:"set",key:c.INIT_DATA,value:ve.get()}).then((n=>{t.sendMessage(O,{requestType:"get",key:c.SUBSCRIPTION_DETAILS}).then((n=>{null!=n.message?this.isTokenValid().then((r=>{var o;r?e({state:Oe.GRANTED,subscriptionDetails:n.message}):(o=t.sendMessage(O,{requestType:"remove",key:c.SUBSCRIPTION_DETAILS}),r=this.removeToken(),Promise.all([o,r]).then((()=>{this.openNewTabForPermission(t).then((t=>{e(t)}))})))})):this.openNewTabForPermission(t).then((t=>{e(t)}))}))}))}))}))}))}openNewTabForPermission(e){return new Promise((t=>{e.sendMessage(k,this.sdkSettings).then((e=>{o.listenToChannel(A,P,((e,n)=>{n("Ok"),e=e.message,t(e)})),window.open(this.sdkSettings.platformSettings.chrome.subdomainURL+"?startSubscription=true","_blank","toolbar=yes,scrollbars=yes,resizable=yes,top=500,left=500,width=400,height=400")}))}))}getCurrentPermissionState(){return new Promise(((e,t)=>{this.getIframeCommunicator().then((t=>{t.sendMessage(D,{requestType:"get"}).then((t=>{e(t.message)}))}))}))}getPushTokenDetails(){return new Promise((e=>{this.getOrSetInSubDomainStorage(c.SUBSCRIPTION_DETAILS).then((t=>{e(t)}))}))}setInSubDomainStorage(e,t){return new Promise((n=>{this.getIframeCommunicator().then((r=>{r.sendMessage(O,{requestType:"set",key:e,value:t}).then((e=>{n(!0)}))}))}))}logout(){return new Promise((e=>{this.getIframeCommunicator().then((t=>{t.sendMessage(O,{requestType:"logout"}).then((t=>{e(!0)}))}))}))}getInSubdomain(e){return xe.baseLogTag,new Promise((t=>{this.getIframeCommunicator().then((n=>{n.sendMessage(O,{requestType:"get",key:e}).then((e=>{null==e.message?t(null):t(e.message)})).catch((e=>{t(null)}))})).catch((e=>{t(null)}))}))}setInSubdomain(e,t){return xe.baseLogTag,new Promise(((n,r)=>{this.getIframeCommunicator().then((o=>{o.sendMessage(O,{requestType:"set",key:e,value:t}).then((e=>{n(!0)})).catch((e=>{r(e)}))})).catch((e=>{r(e)}))}))}getOrSetInSubDomainStorage(e,t){return new Promise((n=>{this.getInSubdomain(e).then((r=>{null==r?this.setInSubdomain(e,t).then((()=>{n(t)})).catch((e=>{n(t)})):n(r)}))}))}isTokenValid(){return new Promise((e=>{this.getPushTokenDetails().then((t=>{t&&t.token?Me.isTokenValid(t.token,this.sdkSettings.platformSettings.chrome.apiKey).then((t=>{t?e(t):this.getIframeCommunicator().then((n=>{n.sendMessage(O,{requestType:"remove",key:c.SUBSCRIPTION_DETAILS}).then((()=>{n.sendMessage(O,{requestType:"remove",key:c.HARD_ASK_STATUS}).then((()=>{e(t)}))}))}))})):e(!1)}))}))}removeToken(){return new Promise((e=>{ne.remove(c.PUSH_TOKEN),this.getIframeCommunicator().then((t=>{t.sendMessage(O,{requestType:"remove",key:c.PUSH_TOKEN}).then((t=>{e(!0)}))}))}))}getIframeCommunicator(){return new Promise((e=>{xe.iframeCommunicator?e(xe.iframeCommunicator):this.getIframe().then((t=>{xe.iframeCommunicator=new o(I,t),e(xe.iframeCommunicator)}))}))}getIframe(){return new Promise(((e,t)=>{if(null==xe.iframe){const t=document.createElement("iframe");t.id="moengage-subd-iframe",t.style.display="none",t.src=this.sdkSettings.platformSettings.chrome.subdomainURL,document.body.appendChild(t),xe.iframe=t,t.addEventListener("load",(()=>{xe.iframeLoaded=!0,e(t)}))}else xe.iframeLoaded?e(xe.iframe):setTimeout((()=>{this.getIframe().then((t=>{e(t)}))}),500)}))}showNotification(e){this.getIframeCommunicator().then((t=>{t.sendMessage(N,{notification:e,config:this.sdkSettings})}))}}xe.baseLogTag="ChromeHTTPNotificationManager",xe.iframeLoaded=!1;class Ue{constructor(){this.isDomainLevelStorage=!1,this.isConfigured=!1,this.isPushSubBilling=!1,this.platformSettings=new qe,this.optInConfig=new We,this.s_i_d=1800,this.c_s=!1,this.a_s="allowed",this.i_b_e=!1,this.s_s_d=!1}static parseOldSettings(t){var n=Ue.baseLogTag+".parseOldSettings";const r=new Ue;if((r.oldWebData=t).webData&&!be(t.webData)){r.isConfigured=!0;var o=t.webData;const i=e(o,"domain_type",null);i&&("http"===i.toLowerCase()?r.platformSettings.chrome.domainType=Ke.DOMAIN_TYPE.HTTP:"https"===i.toLowerCase()?r.platformSettings.chrome.domainType=Ke.DOMAIN_TYPE.HTTPS:"multi"===i.toLowerCase()?r.platformSettings.chrome.domainType=Ke.DOMAIN_TYPE.MUTLI:r.platformSettings.chrome.domainType=Ke.DOMAIN_TYPE.NA),r.platformSettings.chrome.subdomainURL=e(o,"subdomainUrl",null),"false"===e(o,"domain_level_storage",!1)?r.isDomainLevelStorage=!1:r.isDomainLevelStorage=!(!e(o,"domain_level_storage",!1)&&"true"!==e(o,"domain_level_storage",!1)),"allowed"!==(t=e(o,"c_s",!1))&&!0!==t&&"true"!==t||(r.c_s=!0),"blocked"!==(t=e(o,"a_s","allowed"))&&!1!==t&&"false"!==t||(r.a_s="blocked"),"allowed"!==(t=e(o,"i_b_e",!1))&&!0!==t&&"true"!==t||(r.i_b_e=!0),"allowed"!==(t=e(o,"s_s_d",!1))&&!0!==t&&"true"!==t||(r.s_s_d=!0);let s=e(o,"PushSubBilling",!1);"false"===s?s=!1:"true"===s&&(s=!0),(e=>"boolean"==typeof e)(s)||(s=!1),r.isPushSubBilling=s,r.platformSettings.chrome.domainType!==Ke.DOMAIN_TYPE.HTTP&&r.platformSettings.chrome.domainType!==Ke.DOMAIN_TYPE.MUTLI||r.platformSettings.chrome.subdomainURL||mt.warn(1,n,"No sub domain defined for HTTP site"),r.platformSettings.chrome.enabled=!0,r.platformSettings.chrome.apiKey=e(o,"webPushPlatformData.chrome.api_key",""),r.platformSettings.chrome.projectNumber=e(o,"webPushPlatformData.chrome.project_number",null),r.platformSettings.chrome.subscriptionMode=e(o,"webPushPlatformData.chrome.subscriptionMode","normal"),r.platformSettings.chrome.vapidPublicKey=e(o,"webPushPlatformData.chrome.vapidPublicKey",null),r.platformSettings.firefox.enabled=!0,r.platformSettings.firefox.apiKey=e(o,"webPushPlatformData.chrome.api_key",""),r.platformSettings.firefox.projectNumber=e(o,"webPushPlatformData.chrome.project_number",null),r.platformSettings.firefox.subscriptionMode=e(o,"webPushPlatformData.firefox.subscriptionMode","normal"),r.platformSettings.firefox.vapidPublicKey=e(o,"webPushPlatformData.firefox.vapidPublicKey",null),r.platformSettings.safari.websitePushId=e(o,"webPushPlatformData.safari.websitePushId",null),null==r.platformSettings.safari.websitePushId?r.platformSettings.safari.enabled=!1:r.platformSettings.safari.enabled=!0,r.optInConfig.reappearTime=parseInt(e(o,"promptAgain",24)),e(o,"call_push_moengage",!0)?e(o,"banner.banner_flag",null)?r.optInConfig.type=We.TYPE.TWO_STEP:r.optInConfig.type=We.TYPE.ONE_CLICK:(r.optInConfig.type=We.TYPE.SELF_HANDLED,r.optInConfig.reappearTime=0),r.optInConfig.showOverlay=e(o,"show_overlay",!1),r.optInConfig.loadTime=e(o,"load_time",0),r.optInConfig.softAskConfig.desktop.customHTML=e(o,"bannerHtml.web",null),r.optInConfig.softAskConfig.mobile.customHTML=e(o,"bannerHtml.mweb",null),r.platformSettings.chrome.isServiceWorkerRoot=!e(o,"is_service_worker_not_root",!1),r.platformSettings.chrome.serviceWorkerFilename=e(o,"serviceworker_file","serviceworker.js"),""===r.platformSettings.chrome.serviceWorkerFilename&&(r.platformSettings.chrome.serviceWorkerFilename="serviceworker.js"),r.s_i_d=e(o,"s_i_d",1800),r.s_s_s=e(o,"s_s_s","allowed"),r.src_ext=e(o,"src_ext",[]),r.s_e_b_e=e(o,"s_e_b_e","blocked"),r.e_b_c=e(o,"e_b_c",10),r.p_f_t=e(o,"p_f_t",60),r.b_e=e(o,"b_e",[]),r.w_e=e(o,"w_e",[]),r.c_w_p_e=e(o,"c_w_p_e","blocked"),r.o_u_e=e(o,"o_u_e","blocked"),r.s_log=e(o,"s_log","blocked"),r.log_level=e(o,"log_level","verbose")}else r.isConfigured=!1;return r}}Ue.baseLogTag="SdkSettings";class We{constructor(){this.type=We.TYPE.NA,this.reappearTime=24,this.softAskConfig={desktop:new Fe,mobile:new Fe}}}class Fe{constructor(){this.customHTML=null}}(bt=(bt=We=We||{}).TYPE||(bt.TYPE={})).NA="NA",bt.ONE_CLICK="ONE_CLICK",bt.TWO_STEP="TWO_STEP",bt.SELF_HANDLED="SELF_HANDLED";class je{constructor(){this.enabled=!1,this.websitePushId=null}}class Ke{constructor(){this.enabled=!1,this.domainType=Ke.DOMAIN_TYPE.NA,this.isServiceWorkerRoot=!0,this.serviceWorkerFilename="serviceworker.js",this.apiKey="",this.subscriptionMode="normal",this.vapidPublicKey=null}}(Re=(Re=Ke=Ke||{}).DOMAIN_TYPE||(Re.DOMAIN_TYPE={})).NA="NA",Re.HTTP="http",Re.HTTPS="https",Re.MUTLI="multi";class qe{constructor(){this.safari=new je,this.chrome=new Ke,this.firefox=new Ke}}const He=Ue;let ze,Ge=null,Ve=null;class Ye{constructor(n){this.attributes=[],this.subscribedToOldSdk=!1,null==n?(this.deviceUuid=(0,t.v4)(),this.attributes=[],this.deviceAdded=!1):(this.deviceUuid=e(n,"deviceUuid",(0,t.v4)()),this.attributes=e(n,"attributes",[]),this.deviceAdded=e(n,"deviceAdded",!1))}addAttribute(e){const t=Ye.baseLogTag+".addAttribute";return new Promise((n=>{e.key=Ye.getMorphedKey(e.key);let r=-1;for(let t=this.attributes.length-1;0<=t;t--)e.key===this.attributes[t].key&&(r=t);mt.log(2,t,"Adding attribute:",e),0<=r?(this.attributes[r].value,e.value,this.attributes[r].value=e.value):this.attributes.push(e),this.save().then((()=>{n(!0)}))}))}static getLocalUser(){const e=Ye.baseLogTag+".getLocalUser";return new Promise((t=>{var n;ne.get(c.USER_DATA)?(mt.log(2,e,"Found user in localstorage"),n=ne.get(c.USER_DATA),t(new Ye(n))):t(null)}))}static getCookieUser(){return new Promise((e=>{var t=Ye.baseLogTag+".getLocalUser";vt.get(c.USER_DATA)?(mt.log(2,t,"Found user in cookie"),t=vt.get(c.USER_DATA),e(new Ye(t))):e(null)}))}static getSubdomainUser(){return new Promise((e=>{ft.getWebSDKSettings().then((t=>{Ge=new xe(t),Ge.getInSubdomain(c.USER_DATA).then((t=>{e(t?new Ye(t):null)}))})).catch((t=>{e(null)}))}))}static getMigrationUser(){const n=Ye.baseLogTag+".getLocalUser";return new Promise((r=>{var o=localStorage.getItem(c.OLD_SDK.USER_DATA);if(o)try{var i=JSON.parse(o);if(i.is_new_sdk_migrated)r(null);else{const n=new Ye({deviceAdded:e(i,"device_add",!1),deviceUuid:e(i,"uuid",(0,t.v4)())}),o=e(i,"user_attrs",{});for(const e in o)o.hasOwnProperty(e)&&n.attributes.push(new Be(e,o[e]));var s=localStorage.getItem(c.OLD_SDK.PUSH_TOKEN);null!=s&&"NA"!==s&&"null"!==s&&(n.subscribedToOldSdk=!0),r(n)}}catch(o){mt.error(1,n,"Error getting the migration user. Resolving as a new user."),mt.error(1,n,o),r(null)}else r(null)}))}static getSync(){return Ye.instance}static get(){const e=Ye.baseLogTag+".get";return null!=Ve||(Ve=new Promise((t=>{ie.getInstance().then((n=>{ft.getWebSDKSettings().then((r=>{ze=r.isDomainLevelStorage;let o="https";n.isWebPushCompatible()&&(r.platformSettings.chrome.domainType===Ke.DOMAIN_TYPE.HTTP||r.platformSettings.chrome.domainType===Ke.DOMAIN_TYPE.MUTLI&&"http"===Se())&&(o="http");var i=Ye.getLocalUser(),s=r.isDomainLevelStorage?Ye.getCookieUser():"resolved",a="http"===o?Ye.getSubdomainUser():"resolved",l=Ye.getMigrationUser();Promise.all([i,s,a,l]).then((o=>{const i=o[0],s=o[1],a=o[2],l=o[3];o=()=>{s&&"resolved"!==s?(mt.log(1,e,"User resolved from cookie: ",s),s.save().then((e=>{t(e)}))):(mt.log(1,e,"Local user: ",i),new Ye(i).save().then((e=>{t(e)})))},l?l.save().then((n=>{var r=localStorage.getItem(c.OLD_SDK.USER_DATA);if(r){const e=JSON.parse(r);e.is_new_sdk_migrated=!0,localStorage.setItem(c.OLD_SDK.USER_DATA,JSON.stringify(e))}mt.log(1,e,"User resolved from older SDK: ",n),t(n)})):n.isWebPushCompatible()&&(r.platformSettings.chrome.domainType===Ke.DOMAIN_TYPE.HTTP||r.platformSettings.chrome.domainType===Ke.DOMAIN_TYPE.MUTLI&&"http"===Se())&&a&&"resolved"!==a?(mt.log(1,e,"User resolved from subdomain: ",a),a.save().then((e=>{t(e)}))):o()})).catch((t=>{mt.log(1,e,"Error in fetching/creating user",t)}))})).catch((t=>{mt.error(1,e,"Error in getting Web SDK Settings. This might indicate that the App is blocked.")}))}))}))),Ve}static logout(){return new Promise((e=>{Ve=null,(this.instance=null)!=Ge?Ge.logout().then((()=>{e(!0)})):e(!0)}))}save(){const e=Ye.baseLogTag+".save";Ye.isAmpEnabled()&&(this.deviceUuid=vt.get("moe_uuid")),ne.get("WEB_SETTINGS");var t=ne.get(c.WEB_SETTINGS);return"allowed"===(null==t?void 0:t.c_w_p_e)&&(this.deviceUuid=this.deviceUuid||window.MoeWebP.deviceUuid),Ye.instance=this,new Promise((t=>{ne.set(c.USER_DATA,this),vt.setRaw(M,Ye.instance.deviceUuid),null!=Ge?Ge.setInSubDomainStorage(c.USER_DATA,this).then((()=>{t(this)})).catch((n=>{mt.error(1,e,"Error storing value in subdomain"),t(this)})):t(this)}))}static isAmpEnabled(){const e=vt.get(M);return e&&e.includes("amp")}getAttribute(e){let t=null;return e=Ye.getMorphedKey(e),this.attributes.map((n=>{n.key===e&&(t=n.value)})),t}indexOfAttribute(e){let t=-1;return e=Ye.getMorphedKey(e),this.attributes.map(((n,r)=>{n.key===e&&(t=r)})),t}static getMorphedKey(e){switch(e){case"id":e=m;break;case"email":e=v;break;case"name":e=b;break;case"first_name":e=S;break;case"last_name":e=_;break;case"mobile":e=y;break;case"gender":e=E;break;case"birthday":e=T}return e}}Ye.baseLogTag="UserModel",Ye.isResolved=!1,Ye.instance=null;class Qe{constructor(){var e=Qe.baseLogTag+".constructor";const n=void 0;let r=Ye.getSync().getAttribute("id");r=r?r.toString():void 0;const o=window.analytics;let i,s;if(o){s=o._VERSIONS;try{i=o.user().anonymousId()}catch(n){mt.error(1,e,"Error getting anonymous id from segment api",n)}}this.c=void 0,this.h="",this.identifiers=void 0,(r||i)&&(this.identifiers={moe_user_id:r,segment_id:i}),this.meta={bid:(0,t.v4)(),segmentSdkData:o?s:void 0}}}Qe.baseLogTag="ReportPostData";class Je{constructor(e,t,n){Je.baseLogTag,this.type=e,this.getParams=t,this.event=n,this.postData=new Qe;const r={},o={};for(const e of n.attributes)if(e&&null!=e.key&&(this.status=Je.STATUS.VALID,null!=e.value))if("function"==typeof e.value.getMonth){const t={};t[e.key]=Math.round(e.value.getTime()-6e4*e.value.getTimezoneOffset()),null==o.timestamp&&(o.timestamp=[]),o.timestamp.push(t)}else r[e.key]=e.value;this.postData.e=n.name,this.postData.a=r,this.postData.c=be(o)?void 0:o,window&&window.location&&null!=window.location.href&&(this.postData.url=window.location.href)}}Je.baseLogTag="ReportClass",(Re=(bt=Je=Je||{}).STATUS||(bt.STATUS={}))[Re.INVALID=0]="INVALID",Re[Re.VALID=1]="VALID",(bt=bt.REPORT_ADD_TYPE||(bt.REPORT_ADD_TYPE={}))[bt.USER_ATTRIBUTE=0]="USER_ATTRIBUTE",bt[bt.EVENT=1]="EVENT";const Xe=Je;var $e=function(e,t,n,r){return new(n=n||Promise)((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class Ze{static initStore(){return $e(this,void 0,void 0,(function*(){return null==Ze.ready&&(Ze.offlineDataStore=Z.createInstance({driver:[Z.INDEXEDDB,Z.WEBSQL,Z.LOCALSTORAGE],name:"moe_database",storeName:V.NAME}),Ze.ready=Promise.resolve(Ze.offlineDataStore.ready())),yield Ze.ready}))}static initialize(){return $e(this,void 0,void 0,(function*(){yield Ze.initStore()}))}}class et{constructor(e){this.EVENT_ACTION=e.event.name,this.EVENT_ATTRS=tt(e.event.attributes),this.EVENT_G_TIME=(new Date).getTime().toString(),this.EVENT_L_TIME=we(),this.EVENT_ATTRS_CUST=e.postData.c,this.N_I_E=e.postData.nie}}et.baseLogTag="ReportAddViewEvent";const tt=e=>{const t={};return e.forEach((e=>{t[e.key]=e.value})),t};class nt{static visibilityChange(){"hidden"===document.visibilityState&&(nt.windowClosed||st.reactToTriggerEvents())}static beforeUnload(){nt.windowClosed=!0,st.sendBeacon()}static removeEventListeners(){document.removeEventListener("visibilitychange",nt.visibilityChange,!1),window.removeEventListener("beforeunload",nt.beforeUnload,!1)}static addListeners(){document.addEventListener("visibilitychange",nt.visibilityChange,!1),window.addEventListener("beforeunload",nt.beforeUnload,!1)}}nt.windowClosed=!1;const rt=nt;var ot=function(e,t,n,r){return new(n=n||Promise)((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class it{static spliceReports(e=it.reports.length){return it.reports.splice(0,e)}static spliceRemoteLogs(e=it.remoteLogs.length){return it.remoteLogs.splice(0,e)}static shouldCreateNewBatch(){return!it.lastbatchCreatedAt||(new Date).getTime()-it.lastbatchCreatedAt>=Q}static reactToTriggerEvents(){var e=it.baseLogTag+".reactToTriggerEvents";(0<it.reports.length||0<it.remoteLogs.length)&&it.shouldCreateNewBatch()?(mt.log(1,e,`Trigger Events: Created Batch of ${it.reports.length} reports`,we()),it.createBatch()):mt.log(2,e,we()+": No report's to sync for this event.")}static periodicSync(e){var t=it.baseLogTag+".periodicSync";(0<it.reports.length||0<it.remoteLogs.length)&&it.shouldCreateNewBatch()?(mt.log(1,t,`Periodic sync: Created Batch of ${it.reports.length} reports`,we()),it.createBatch()):mt.log(2,t,we()+`: No report's to sync at this interval. The next sync will attempt in ${e} seconds`)}static clearInterval(){clearInterval(it.periodicSyncInterval),it.lastbatchCreatedAt=null}static init(e){ie.getInstance().then((t=>{it.isOfflineBatchingSupported(t)&&(it.periodicSyncInterval&&it.clearInterval(),it.periodicSyncInterval=window.setInterval(it.periodicSync.bind(this,e.p_f_t),1e3*e.p_f_t),rt.addListeners())}))}static sendBatch(e){return ot(this,void 0,void 0,(function*(){var t=it.baseLogTag+".sendBatch";try{yield ft.sendBatchOfReports(e).then((()=>{it.lastbatchCreatedAt=(new Date).getTime()}))}catch(e){mt.error(1,t,"Error in sending batch",e)}}))}static sendRemoteLogs(e){return ot(this,void 0,void 0,(function*(){var t=it.baseLogTag+".sendRemoteLogs";try{yield ft.sendBatchOfLogs(e).then((()=>{it.lastbatchCreatedAt=(new Date).getTime()}))}catch(e){mt.error(1,t,"Error in sending batch",e)}}))}static createBatch(e){var t;0<it.reports.length&&(t=it.spliceReports(e),it.sendBatch(t)),0<it.remoteLogs.length&&(e=it.spliceRemoteLogs(e),it.sendRemoteLogs(e))}static addReport(e,t){var n=it.baseLogTag+".addReport";e=new et(e),it.reports.push(e),it.reports.length===t&&(mt.log(1,n,`Created Batch of ${t} reports`,we()),it.createBatch(t))}static sendBeacon(){var e=it.baseLogTag+".sendBeacon";0<it.reports.length&&(ft.sendBeacon(it.reports),mt.log(1,e,`Window Unload: Created batch of ${it.reports.length} reports`,we()))}static flushReports(){return ot(this,void 0,void 0,(function*(){var e=it.baseLogTag+".flushReports";try{rt.removeEventListeners(),0<it.reports.length&&(mt.log(1,e,`Flushed ${it.reports.length} reports`,we()),yield it.sendBatch(it.spliceReports()),yield it.sendRemoteLogs(it.spliceRemoteLogs()))}catch(t){mt.error(1,e,"Error in flushing reports",t)}}))}static isOfflineBatchingSupported(e){return Ee(ne.get(c.WEB_SETTINGS),e)}static addLogs(e,t=15){var n=it.baseLogTag+".addReport";it.remoteLogs.push(e),it.remoteLogs.length===t&&(mt.log(1,n,`Created Batch of ${t} reports`,we()),it.createBatch(t))}}it.baseLogTag="BatchManager",it.reports=[],it.remoteLogs=[],it.lastbatchCreatedAt=null;const st=it;class at{static getListeners(){return this.listeners}static getTopicListeners(t){return e(at.topicListeners,t,[])}static addListener(e){at.listeners.push(e)}static addTopicListener(e,t){at.topicListeners[e]=at.getTopicListeners(e),at.topicListeners[e].push(t)}static broadcast(t){at.listeners.map((e=>{e(t)})),e(at.topicListeners,t.topic,[]).map((e=>{e(t)}))}static broadcastToWindow(e){window&&window.dispatchEvent(new CustomEvent(e.topic,{detail:{name:e.name,data:e.data||null}}))}static deprecatedSdkCallback(e){window.dispatchEvent(new CustomEvent("MOE_OPT_IN",{detail:e}))}static resetAllListeners(){at.listeners=[],at.topicListeners={}}}at.listeners=[],at.topicListeners={};const ct=at;class lt{constructor(e,t,n=!0){this.name=e,this.attributes=t,n&&this.attributes.push(new Be("URL",location.href))}static createUserAttributeEvent(e){return new Promise(((t,n)=>{const r=[],o=e.key;switch(e.key){case"id":e.key=m;break;case"email":e.key=v;break;case"name":e.key=b;break;case"first_name":e.key=S;break;case"last_name":e.key=_;break;case"mobile":e.key=y;break;case"gender":e.key=E;break;case"birthday":e.key=T}r.push(e),Ye.get().then((n=>{var i=n.indexOfAttribute("oldUniqueIds");e.key===m&&-1<i&&null!=n.attributes[i].value&&0<n.attributes[i].value.length&&r.push(new Be(w,n.attributes[i].value[n.attributes[i].value.length-1])),e.key!==o&&mt.log(2,"Event.createUserAttributeEvent","Key changed to MoE reserved keyname: ",e.key),t(new lt("EVENT_ACTION_USER_ATTRIBUTE",r,!1))}))}))}static createEvent(e,t,n){return new Promise(((r,o)=>{Ye.get().then((o=>function(e,t,n,r){return new(n=n||Promise)((function(t,o){function i(e){try{a(r.next(e))}catch(e){o(e)}}function s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n((function(e){e(r)}))).then(i,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function*(){try{var i=new Be("moe_logged_in_status",!!o.getAttribute("id"));const a=new Pe;var s=new Be("moe_first_visit",a.getNumberOfSessions()<=1);t.push(i,s),r(new lt(e,t,n))}catch(i){mt.error(1,"Event.createEvent","Error occurred in create events ",i)}}))))}))}}class ut{static addEvent(e){ut.history.push(e),ut.listeners.forEach((t=>{t(e)}))}static getHistory(){return ut.history}static addEventListener(e){ut.listeners.push(e)}static clear(){ut.history=[]}}ut.history=[],ut.listeners=[];class dt{static track(e,t,n){const r="MoEngage.event.trackEvent";return new Promise(((o,i)=>function(e,t,n,r){return new(n=n||Promise)((function(t,o){function i(e){try{a(r.next(e))}catch(e){o(e)}}function s(e){try{a(r.throw(e))}catch(e){o(e)}}function a(e){var r;e.done?t(e.value):((r=e.value)instanceof n?r:new n((function(e){e(r)}))).then(i,s)}a((r=r.apply(e,[])).next())}))}(this,0,void 0,(function*(){var i;let s;n=!!n;try{s=yield ft.getWebSDKSettings()}catch(i){return void mt.error(1,r,"Error in getting Web SDK Settings. This might indicate that the App is blocked.")}if("string"==typeof e&&e)if(s.b_e&&s.b_e.includes(e))mt.log(1,r,`This event "${e}" is blacklisted. Please contact Moengage team to whitelist it.`),o({error:5001,message:`Event "${e}" is blacklisted.`});else if(!X.includes(e)||s.w_e&&s.w_e.includes(e))try{const a=[];if(null==t||null!==t&&t===Object(t)&&"[object Object]"===Object.prototype.toString.call(t)){for(const e in t=null==t?{}:t)t.hasOwnProperty(e)&&a.push(new Be(e,t[e]));const r=new Pe;yield r.initiateSessionAndSource(s.s_s_d);const c=yield lt.createEvent(e,a);ut.addEvent(c),"allowed"===(null==s?void 0:s.c_w_p_e)&&null!==(i=window.MoeWebP)&&void 0!==i&&i.handleInSessionEvent(c),ft.collectGetParams().then((t=>{e===u&&delete t.push_id;const i=new Xe(Xe.REPORT_ADD_TYPE.EVENT,t,c);var a={session_id:r.getSessionKey(),start_time:r.getSessionStartTime(),background_initiated:0};const l=[];(t=r.getActiveSource())&&(r.setCurrentSource(t),l.push(t)),i.postData.meta.session=a,l.length&&(i.postData.meta.source=l),r.isNonEventInteractive(c)&&(i.postData.nie=1),ft.reportAdd(i,n).then((()=>{s.s_s_s!==G.ALLOWED||r.isNonEventInteractive(c)||r.extendSession(),o(!0)}))}))}else mt.error(1,r,"Event attributes were not passed a key-value pair object for event: ",e),o({error:5002,message:"Event value needs to be a key-value pair object"})}catch(i){mt.error(1,r,"Error occurred in tracking events ",i)}else mt.log(1,r,`This event "${e}" has not been whitelisted. Please contact Moengage team to whitelist it.`),o({error:5001,message:`Event "${e}" is not whitelisted.`});else mt.log(1,r,"Event name not a string or null or empty string:",e),o({error:5001,message:"Event name can not be null"})}))))}}var gt=function(e,t,n,r){return new(n=n||Promise)((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class ft{static deviceAdd(){return new Promise(((e,t)=>{const n=ve.get();return ft.collectGetParams().then((r=>{r={queryParams:r},ke.post(n.baseDomainName+"v2/device/add",r).then((()=>{let t=ye().toUpperCase();t="WEB"===t?"DESKTOP":t,dt.track(p,{deviceType:t}),Ye.get().then((t=>{t.deviceAdded=!0,t.save().then((()=>{Le.startPeriodicClear(c.Q.REPORT),ft.onDeviceAdd.res(),e(!0)}))}))})).catch((e=>{ee.enqueue(c.Q.DEVICE,!0),t(!1)}))}))}))}static reportAdd(e,t){const n=ft.baseLogTag+".reportAdd";return new Promise(((r,o)=>(t=!!t,ft.getWebSDKSettings().then((i=>{i.isPushSubBilling?Ye.get().then((i=>{i.deviceAdded?ft.reportAddInternal(e,t).then((()=>{this.sendBroadcast(e),r(!0)})).catch((()=>{o(!1)})):(ee.enqueue(c.Q.REPORT,e),mt.log(1,n,"Report added to queue as device not added yet:",e.event.name),mt.log(2,n,"Event Queued:",e.event.name),e.type===Xe.REPORT_ADD_TYPE.USER_ATTRIBUTE&&(ft.isPushSubAttributeAccepted(e.event.attributes[0].key)?(mt.log(1,n,"Attribute accepted for push sub billing."),ft.deviceAdd()):mt.log(2,n,"Attribute NOT accepted for push sub billing.")),r(!0))})):ft.reportAddInternal(e,t).then((()=>{this.sendBroadcast(e),r(!0)})).catch((()=>{o(!1)}))})).catch((e=>{mt.error(1,n,"Error in getting Web SDK Settings. This might indicate that the App is blocked."),o(!1)})))))}static sendBroadcast(e){J.NAMES.includes(e.event.name)&&ct.broadcastToWindow({topic:J.TOPIC,name:e.event.name,data:e.event.attributes})}static getSegmentId(){const e=window.analytics;if(e&&e.user)return e.user().anonymousId()}static getBatchRequestOptions(e){return new Promise((n=>{ft.collectGetParams().then((r=>{var o=ft.getSegmentId()||"";const i=Ye.getSync(),s=new Pe;var a={session_id:s.getSessionKey(),start_time:s.getSessionStartTime(),background_initiated:0};const c=[];var l=s.getActiveSource();l&&(s.setCurrentSource(l),c.push(l)),a={query_params:r,identifiers:{moe_user_id:i.getAttribute("id")||void 0,segment_id:o||void 0},meta:{bid:(0,t.v4)(),request_time:(new Date).toISOString(),session:a,source:c.length?c:void 0},viewsCount:e.length,viewsInfo:[...e]},n(a)}))}))}static getRemoteLogsBatchRequestOptions(e){return new Promise((t=>{ft.collectGetParams().then((n=>{n={query_params:Object.assign(Object.assign({},n),{logs:[...e]})},t(n)}))}))}static addReportsToOfflineDB(e,t){return gt(this,void 0,void 0,(function*(){const n=ft.baseLogTag+".addReportsToOfflineDB";var r=yield ft.getBatchRequestOptions([]);yield Ze.offlineDataStore.setItem(t||"report_add_"+(new Date).getTime(),e),yield Ze.offlineDataStore.setItem("requestMetaData",r),navigator.serviceWorker&&navigator.serviceWorker.ready.then((e=>{e.sync?e.sync.register("moe_offline_data_sync").then((()=>{mt.log(2,n,"offline sync event registered")})).catch((e=>{mt.error(1,n,"Service worker sync error",e)})):mt.log(2,n,"Service worker sync unavailable")}))}))}static sendReportBeacon(e,t,n){return!!(e&&navigator.sendBeacon&&navigator.sendBeacon(t,new Blob([JSON.stringify(n)],{type:"text/plain;charset=UTF-8"})))}static sendBatchOfReports(e){const t=ft.baseLogTag+".sendBatchOfReports";return new Promise(((n,r)=>{ft.getBatchRequestOptions(e).then((o=>{var i=ve.get();const s=i.baseDomainName+Y+i.appId;ft.getWebSDKSettings().then((i=>ft.sendReportBeacon(i.i_b_e,s,o)?(mt.log(1,t,"[sendBatchOfReports] batch payload: "+JSON.stringify(e)),mt.log(1,t,"Batch sent to MoEngage successfully through beacon"),void n(!0)):void ke.post(s,{postData:o}).then((()=>{mt.log(1,t,"[sendBatchOfReports] batch payload: "+JSON.stringify(e)),mt.log(1,t,"Batch sent to MoEngage successfully"),n(!0)})).catch((o=>{mt.error(1,t,"Batch Report add API failed",o),ie.getInstance().then((i=>{st.isOfflineBatchingSupported(i)?(ft.addReportsToOfflineDB(e).then((()=>{mt.remoteLogTracking(2,t,"Network offline: Batch added to offline db")})),n(!0)):r(o)})).catch((()=>{r(o)}))})))).catch((e=>{mt.error(1,t,"Error in getting Web SDK Settings. This might indicate that the App is blocked."),r(e)}))}))}))}static sendBatchOfLogs(e){const t=ft.baseLogTag+".sendBatchOfLogs";return new Promise(((n,r)=>{ft.getRemoteLogsBatchRequestOptions(e).then((r=>{var o=(o=ve.get()).baseDomainName+"v1/sdk_logging/"+r.query_params.os+"/"+o.appId;ke.post(o,{headers:{"Content-Type":"application/json"},postData:r}).then((()=>{mt.log(1,t,"[sendBatchOfLogs] batch payload: "+JSON.stringify(e)),mt.log(1,t,"Batch Remote Logs sent to MoEngage successfully"),n(!0)})).catch((e=>{mt.log(1,t,"Batch Remote Logs API failed",e)}))}))}))}static reportAddInternal(t,n){const r=ft.baseLogTag+".reportAddInternal";return new Promise(((o,i)=>{ft.getWebSDKSettings().then((i=>{ie.getInstance().then((s=>{if("allowed"!==i.s_e_b_e||n){const a=ft.getUpdatedPushDetails();for(const e in a)!a.hasOwnProperty(e)||t.event.name===u&&"push_id"===e||(t.getParams[e]=a[e]);const l={queryParams:t.getParams};if(t.postData.nie){const e=Object.assign({},t);delete e.postData.meta.source,delete e.postData.meta.session,l.postData=e.postData}else l.postData=t.postData;let d=ve.get().baseDomainName;if(d+=n?"v2/device/add":"v2/report/add",!d.includes("v2/device/add")&&ft.sendReportBeacon(i.i_b_e,Ae(d,e(l,"queryParams",null)),l.postData))return mt.log(1,r,"Event tracked through beacon:",t.event),void o(ft.handleReportAddSuccess(t));ke.post(d,l).then((()=>{if(d.includes("v2/device/add")){let e=ye().toUpperCase();e="WEB"===e?"DESKTOP":e,dt.track(p,{deviceType:e})}o(ft.handleReportAddSuccess(t))})).catch((e=>{var o;Ee(i,s)?(mt.error(1,r,"Add Report API failed, adding reports to offline db",e),n?ee.enqueue(c.Q.DEVICE,t):(o=new et(t),ft.offlineEvents.push(o),ft.addReportsToOfflineDB(ft.offlineEvents,"report_add").then((()=>{mt.remoteLogTracking(2,r,"Network offline: Batch added to offline db")})))):ft.handleReportAddFailure(t,e)}))}else{var a;Ee(i,s)?(st.addReport(t,i.e_b_c),mt.log(1,r,"Event batched successfully:",t.event),ft.eventStore.setItem(t.event.name,t.event),o(!0)):(a=new et(t),ft.sendBatchOfReports([a]).then((()=>{o(ft.handleReportAddSuccess(t))})).catch((e=>{ft.handleReportAddFailure(t,e)})))}}))})).catch((e=>{mt.error(1,r,"Error in getting Web SDK Settings. This might indicate that the App is blocked."),i(!1)}))}))}static handleReportAddSuccess(e){var t=ft.baseLogTag+".handleReportAddSuccess";return e.type===Xe.REPORT_ADD_TYPE.EVENT?(mt.log(1,t,"Event tracked successfully:",e.event),ft.eventStore.setItem(e.event.name,e.event)):e.type===Xe.REPORT_ADD_TYPE.USER_ATTRIBUTE&&mt.log(1,t,"User attribute added successfully:",e.event.attributes),ft.addReportApiRetries=1,!0}static handleReportAddFailure(e,t){var n=ft.baseLogTag+".handleReportAddFailure";mt.error(1,n,"Add Report API failed",t),e.type===Xe.REPORT_ADD_TYPE.EVENT?mt.log(1,n,"Queueing unsuccessful event tracking:",e.event):e.type===Xe.REPORT_ADD_TYPE.USER_ATTRIBUTE&&mt.log(1,n,"Queueing unsuccessful user attribute add:",e.event.attributes),ft.addReportApiRetries<3&&setTimeout((()=>{ft.addReportApiRetries++,ee.enqueue(c.Q.REPORT,e),Le.startPeriodicClear(c.Q.REPORT)}),3e3*ft.addReportApiRetries)}static checkIfTokenValid(e){const t=ve.get().baseDomainName+"v2/device/token-check",n=ve.get();return new Promise((r=>{e?Ye.get().then((o=>{o={queryParams:{app_id:n.appId,unique_id:o.deviceUuid,push_id:e}},ke.post(t,o).then((e=>{200===e.status?r(!0):r(!1)})).catch((e=>{r(!1)}))})):r(!1)}))}static isAppBlocked(e){return!(!e||"blocked"!==e.a_s)}static getWebSDKSettings(){return new Promise(((e,t)=>{let n=ve.get();var r,o;null!=n&&null!=n.appId||(n=new ve(ne.get(c.INIT_DATA))),ft.sdkSettings?ft.isAppBlocked(ft.sdkSettings)?t(!1):e(ft.sdkSettings):(r=(new Date).getTime(),null==(o=ne.get(c.SETUP_TIME))||0<n.debugLevel||864e5<r-o?ft.getAndPersistWebSettings(n).then((t=>{e(t)})).catch((e=>{t(!1)})):ne.get(c.WEB_SETTINGS)?(ft.sdkSettings=ne.get(c.WEB_SETTINGS),ft.isAppBlocked(ft.sdkSettings)?t(!1):e(ft.sdkSettings)):ft.getAndPersistWebSettings(n).then((t=>{e(t)})).catch((e=>{t(!1)})))}))}static getAndPersistWebSettings(e){const t=ft.baseLogTag+".getAndPersistWebSettings";return new Promise(((n,r)=>gt(this,void 0,void 0,(function*(){try{var o={queryParams:{app_id:(e=null==e.appId?new ve(ne.get(c.INIT_DATA)):e).appId}};mt.log(1,t,"Fetching latest web sdk settings for",e.appId);var i=yield ke.get(e.baseDomainName+"websdksettings",o);mt.log(1,t,"Fetching config settings for",e.appId);let h=i.responseText;"string"==typeof h&&(h=JSON.parse(h));var s=_e()?"mweb":"web",a=e.baseDomainName+B+s+"/"+e.appId;try{var l,u=ne.get(c.USER_DATA),d={headers:{"MOE-APPKEY":e.appId},postData:{query_params:{unique_id:u&&u.deviceUuid}}},g=yield ke.post(a,d);mt.log(1,t,"Fetched latest web and config settings"),200===g.status&&(l=g.responseText,l=JSON.parse(l),h.webData=Object.assign(Object.assign({},h.webData),l))}catch(e){mt.error(1,t,"Config API failed")}var f=(new Date).getTime();if(h=He.parseOldSettings(h),ne.set(c.WEB_SETTINGS,h),ne.set(c.SETUP_TIME,f),ft.isAppBlocked(h))return void r(!1);ft.sdkSettings=h,n(h)}catch(o){mt.error(1,t,"Settings APi Failed: ",o),ft.webSdkApiRetries<3?setTimeout((()=>{ft.webSdkApiRetries++,n(ft.getAndPersistWebSettings(e))}),3e3*ft.webSdkApiRetries):r(!1)}}))))}static collectGetParams(){return new Promise(((e,t)=>{Ye.get().then((t=>{let n=ve.get();null!=n&&null!=n.appId||(n=new ve(ne.get(c.INIT_DATA)));const r=new Date,o=Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds());ie.getInstance().then((r=>{const i={os:r.os,os_platform:r.osPlatform,is_incognito:r.isIncognito,app_id:n.appId,os_ver:r.name,sdk_ver:"5.0.214",model:r.name,app_ver:"1.0",device_ts:Number(o),device_tz_offset:(-6e4*(new Date).getTimezoneOffset()).toString(),unique_id:t.deviceUuid,device_tz:(new Date).getTimezoneOffset().toString()};var s,a=ne.get(c.PUSH_TOKEN);null!=a&&"NA"!==a&&""!==a&&"null"!==a&&(i.push_id=a),r.isWebPushCompatible()&&(s=this.sdkSettings.platformSettings,((a=r).isChrome()||a.isOpera()||a.isEdge()||a.isSafari()?"vapid"===s.chrome.subscriptionMode&&s.chrome.vapidPublicKey:a.isFirefox()&&"vapid"===s.firefox.subscriptionMode&&s.firefox.vapidPublicKey)?(i.subscription_type="vapid",i.vapid_public=(a=this.sdkSettings.platformSettings,(s=r).isChrome()||s.isOpera()||s.isEdge()||s.isSafari()?a.chrome.vapidPublicKey:s.isFirefox()?a.firefox.vapidPublicKey:"")):i.subscription_type="normal",i.sender_id=this.sdkSettings.platformSettings.chrome.projectNumber),null!=n.environment&&(i.environment=n.environment),r.name===ie.BROWSER_NAMES.SAFARI&&(i.websitePushId=this.sdkSettings.platformSettings.safari.websitePushId);var l=ne.get(c.SUBSCRIPTION_DETAILS);if(null!=l&&null!=l.keys){for(const e in l.keys)i["keys_"+e]=encodeURI(l.keys[e]);null!=l.endpoint&&(i.endpoint=encodeURI(l.endpoint)),i.expirationTime=l.expirationTime}e(i)}))}))}))}static getUpdatedPushDetails(){const e={};var t=ne.get(c.SUBSCRIPTION_DETAILS);if(null!=t){var n=ne.get(c.PUSH_TOKEN);if(null!=n&&"NA"!==n&&""!==n&&"null"!==n&&(e.push_id=n),t.keys){for(const n in t.keys)e["keys_"+n]=encodeURI(t.keys[n]);null!=t.endpoint&&(e.endpoint=encodeURI(t.endpoint)),e.expirationTime=t.expirationTime}}return e}static isPushSubAttributeAccepted(e){return e===v||e===y}static sendBeacon(e){ft.getBatchRequestOptions(e).then((e=>{var t=(t=ve.get()).baseDomainName+Y+t.appId+"?"+(new Date).getTime();mt.log(1,"MoeApi.sendBeacon","[sendBeacon] batch payload: "+JSON.stringify(e)),navigator.sendBeacon(t,JSON.stringify(e))}))}}ft.baseLogTag="MoeApi",ft.onDeviceAdd=new class{constructor(){this.p=null,this.res=null,this.rej=null;try{this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}catch(e){mt.error(1,"Utils.PromiseObject","Promises not supported")}}},ft.webSdkApiRetries=1,ft.offlineEvents=[],ft.addReportApiRetries=1,ft.eventStore=Z.createInstance({driver:[Z.INDEXEDDB,Z.WEBSQL,Z.LOCALSTORAGE],name:"moe_tracking",storeName:"events"});class ht{static logData(e,t){return{log_type:e,sent_time:(new Date).toISOString(),lake_fields:t}}static isRemoteTrackingEnabled(){return e=this,n=function*(){if(this.isTrackingEnabled)return this.isTrackingEnabled;var e=yield ft.getWebSDKSettings();return this.logLevel=null==e?void 0:e.log_level,this.isTrackingEnabled=null==e?void 0:e.s_log,this.isTrackingEnabled},new(t=(t=void 0)||Promise)((function(r,o){function i(e){try{a(n.next(e))}catch(e){o(e)}}function s(e){try{a(n.throw(e))}catch(e){o(e)}}function a(e){var n;e.done?r(e.value):((n=e.value)instanceof t?n:new t((function(e){e(n)}))).then(i,s)}a((n=n.apply(e,[])).next())}));var e,t,n}static log(e,t,n,r,...o){e!==this.logLevel&&"verbose"!==this.logLevel||this.isTrackingEnabled&&st.addLogs(this.logData(e,{msg:n+[...o].toString(),file_name:t,trace:r}))}}let pt="color: white; background: #41AE55; border-radius: 5px;";class mt{static setLogLevel(e,t){var n=mt.baseLogTag+".setLogLevel";null==$.get(a)&&$.set(a,[]),null==e?mt.logLevel=0:e in[0,1,2]?0<(mt.logLevel=e)&&t&&mt.releaseAllLogs():mt.warn(0,n,"Value",e,"not supported for setDebugLevel(). Current log level is",mt.logLevel,". Debug level can only be [0, 1, 2]")}static setLogTabStyle(e){mt.tagLogStyle=mt.tagLogStyle.replace("#48beab",e)}static log(e,t,n,...r){e<=mt.logLevel?console.log("%c "+mt.logBrand+" %c %c info %c %c "+t+" ",pt,"","color: white; background: #18a0bf; border-radius: 5px;","",mt.tagLogStyle,n,...r):mt.cacheLog((()=>{mt.log(e,t,n,...r)}))}static remoteLogTracking(e,t,n,...r){ht.log("info",t,n,"",r),this.log(e,t,n,r)}static error(e,t,n,...r){ht.log("error",mt.logBrand,t,n,r),e<=mt.logLevel?console.error("%c "+mt.logBrand+" %c %c error %c %c "+t+" ",pt,"","color: white; background: #cc0a0a; border-radius: 5px;","",mt.tagLogStyle,n,...r):mt.cacheLog((()=>{mt.error(e,t,n,...r)}))}static warn(e,t,n,...r){ht.log("warning",t,n,...r),e<=mt.logLevel?console.warn("%c "+mt.logBrand+" %c %c warn %c %c "+t+" ",pt,"","color: white; background: #e8ab51; border-radius: 5px;","",mt.tagLogStyle,n,...r):mt.cacheLog((()=>{mt.warn(e,t,n,...r)}))}static customLabel(e,t,n,...r){e<=mt.logLevel?console.log("%c "+mt.logBrand+" %c %c "+t+" %c %c "+n+" %c ",pt,"",mt.tagLogStyle,"","color: white; background: #a400ff; border-radius: 5px;","",...r):mt.cacheLog((()=>{mt.customLabel(e,t,n,...r)}))}static image(e,t){e<=mt.logLevel?console.log("%c+","font-size: 1px; padding: 20px 80px; line-height: 45px; background: url("+t+"); background-size: 160px 90px; color: transparent;"):mt.cacheLog((()=>{mt.image(e,t)}))}static releaseAllLogs(){var e=$.get(a),t=e.length;const n=e;if($.set(a,[]),0<t){mt.log(0,"Logger.releaseAllLogs","<---- HISTORICAL LOGS BEGIN ----\x3e");for(let e=0;e<t;e++)n[e]();mt.log(0,"Logger.releaseAllLogs","<---- HISTORICAL LOGS END ----\x3e")}}static setLogBrand(e){mt.logBrand=e}static setBrandColor(e){pt="color: white; background: "+e+"; border-radius: 5px;"}static cacheLog(e){let t=$.get(a);null==t&&(t=[]),t.push(e),$.set(a,t)}}mt.baseLogTag="Logger",mt.logBrand="MoEngage",mt.logLevel=0,mt.tagLogStyle="color: white; background: #48beab; border-radius: 5px;";class vt{static set(e,t){var n=vt.baseTag+".set";null==t?vt.remove(e):(t="boolean"==typeof t?JSON.stringify({actualValue:t,MOE_DATA_TYPE:"boolean"}):"string"==typeof t?JSON.stringify({actualValue:t,MOE_DATA_TYPE:"string"}):JSON.stringify(t),mt.log(3,n,"Setting ",e,":",t),n=Date.now(),n=";expires="+new Date(n+31536e6*l).toUTCString(),document.cookie=e+"="+encodeURIComponent(t)+n+";domain="+vt.getOrigin()+";path=/;SameSite=None; Secure")}static get(t){var n=vt.baseTag+".get",r=t+"=",o=decodeURIComponent(document.cookie).split(";");for(let i=o.length-1;0<=i;i--){let s=o[i];for(;" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(r)){let o=s.substring(r.length,s.length);try{o=JSON.parse(o),"string"===e(o,"MOE_DATA_TYPE",null)?(o=e(o,"actualValue",null),o=o?String(o):null):"boolean"===e(o,"MOE_DATA_TYPE",null)&&(o=e(o,"actualValue",null))}catch(e){}return mt.log(3,n,"Got ",t,":",o),o}}return null}static remove(e){var t=vt.baseTag+".remove";document.cookie=e+"=;domain="+vt.getOrigin()+";path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;",mt.log(3,t,"Removed ",e)}static setRaw(e,t,n){var r=vt.baseTag+".setRaw";if(null==t)vt.remove(e);else{mt.log(3,r,"Setting ",e,":",t);let o="";null!=n&&(o=";expires="+n.toISOString()),document.cookie=e+"="+encodeURIComponent(t)+o+";domain="+vt.getOrigin()+";path=/;"}}static getOrigin(){var e=vt.baseTag+".getOrigin";let t=window.location.origin;return t=t.indexOf(".")!==t.lastIndexOf(".")?t.substring(t.indexOf(".")):"."+t.substring(t.lastIndexOf("/")+1),"localhost"===window.location.hostname&&(mt.warn(1,e,"Cross domain user persitence will not work with localhost. \n\nWe will save the key-value pairs in the localhost cookie store for reference. You'll be able to test this functionality in a hosted staging/test environment."),t=""),t}}vt.baseTag="CookieStorage";var bt=()=>{const e=window.location.search.substring(1).split("&"),t={};for(let i=0;i<e.length;i++){var n=e[i].split("="),r=decodeURIComponent(n[0]),o=decodeURIComponent(n[1]);void 0===t[r]?t[r]=decodeURIComponent(o):"string"==typeof t[r]?(n=[t[r],decodeURIComponent(o)],t[r]=n):t[r].push(decodeURIComponent(o))}return t};window.getParams=bt;function St(e,t,n){document.cookie=e+"="+t+";expires="+n.toUTCString()+";domain=.moengage.com;path=/;SameSite=None; Secure"}!function(t){if(e(t,"action")&&"inapp_test"===t.action){var n=t.redirect_url,r=t.draft_id,o=t.draft_campaign_tag,i=t.draft_type||x,s=t.template_type||null,a=t.campaign_meta||null,c=t.locale||null;if(t=t.variation||null,null!=n)if(null!=r){if(i!==x||null!=o){const e=new Date;return e.setTime(e.getTime()+3e4),St(W,i,e),St(F,r,e),St(j,o,e),St(K,a,e),St(q,s,e),St(z,c,e),St(H,t,e),window.location.href=n}console.error("Please specify a 'draft_campaign_tag' in the queryParams")}else console.error("Please specify a 'draft_id' in the queryParams");else console.error("Please specify a 'redirect_url' in the queryParams")}}(bt()),o.listenToChannel("inapp_helper","COOKIE_STORAGE",((e,t)=>{if(e.message&&"GET"===e.message.TYPE)if(e.message.KEY===F)if(null==(e=vt.get(F)))t();else try{t({draft_type:vt.get(W),draft_id:e,draft_tag:vt.get(j),campaign_meta:vt.get(K),template_type:vt.get(q),locale:vt.get(z),variation:vt.get(H)})}catch(e){console.error(e),t()}else t()})),window.getParams=bt})()})();